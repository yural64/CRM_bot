# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
_Exported on 12/3/2025 at 13:24:07 GMT+3 from Cursor (2.1.39)_

---

**User**

—Å–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∏ –≤ –Ω–µ–≥–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

**Cursor**

I'll help you create a virtual environment and install all dependencies. Let me first check what's in your project to understand the dependencies.

–û—Ç–ª–∏—á–Ω–æ! –Ø –≤–∏–∂—É, —á—Ç–æ —É –≤–∞—Å Python –ø—Ä–æ–µ–∫—Ç —Å —Ñ–∞–π–ª–æ–º `requirements.txt`. –°–µ–π—á–∞—Å —Å–æ–∑–¥–∞–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–ª—é –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ –∏ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:**
- pyTelegramBotAPI 4.29.1
- psycopg2-binary 2.9.11
- python-dotenv 1.2.1
- requests 2.32.5
- –ò –¥—Ä—É–≥–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≤ –±—É–¥—É—â–µ–º:**

–î–ª—è PowerShell:
```powershell
.\venv\Scripts\Activate.ps1
```

–ï—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```powershell
.\venv\Scripts\python.exe your_script.py
```

–ò–ª–∏ –¥–ª—è Command Prompt:
```cmd
venv\Scripts\activate.bat
```

**–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:**
```powershell
.\venv\Scripts\python.exe bot.py
```

–¢–µ–ø–µ—Ä—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –ù–µ –∑–∞–±—É–¥—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∞–π–ª `.env` —Å –≤–∞—à–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `env.example.txt` –∫–∞–∫ –æ–±—Ä–∞–∑–µ—Ü).

```powershell
.\venv\Scripts\Activate.ps1
```

```powershell
.\venv\Scripts\python.exe your_script.py
```

```plaintext
venv\Scripts\activate.bat
```

```powershell
.\venv\Scripts\python.exe bot.py
```

---

**User**

–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤ –Ω–µ–º –Ω–µ—Ç —É—Å–ª—É–≥. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞. –ü–æ–¥–±–µ—Ä–∏ —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ (–µ–∂–µ–≥–æ–¥–Ω–æ–µ –¢–û, —Ä–µ–º–æ–Ω—Ç, –∑–∞–º–µ–Ω–∞ —Ä–∞—Å—Ö–æ–¥–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ —Ç.–¥). –°–¥–µ–ª–∞–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Å–æ—Å—Ç–∞–≤—å —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ —Å–æ –≤—Å–µ–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –≤ –ë–î

---

**Cursor**

–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞. –°–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä—é —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –±–æ—Ç–∞, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã –Ω—É–∂–Ω—ã –¥–ª—è —É—Å–ª—É–≥.

–û—Ç–ª–∏—á–Ω–æ! –Ø –∏–∑—É—á–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–æ—Ç–∞ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–º –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –∏ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Ö –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ë–î.

## –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–Ø –ø–æ–¥–æ–±—Ä–∞–ª –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.
–ó–∞–ø—É—Å–∫–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥.
"""

from database import db

# –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
AUTOSERVICE_SERVICES = [
    # ===================== –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–ï =====================
    {
        'name': '–¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)',
        'price': 3500.00,
        'duration_minutes': 120,
        'description': '–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º'
    },
    {
        'name': '–¢–û-2 (30 —Ç—ã—Å. –∫–º)',
        'price': 7500.00,
        'duration_minutes': 180,
        'description': '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤'
    },
    {
        'name': '–¢–û-3 (60 —Ç—ã—Å. –∫–º)',
        'price': 12000.00,
        'duration_minutes': 240,
        'description': '–ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤'
    },
    {
        'name': '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
        'price': 8000.00,
        'duration_minutes': 300,
        'description': '–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞'
    },
    
    # ===================== –ó–ê–ú–ï–ù–ê –ú–ê–°–ï–õ –ò –ñ–ò–î–ö–û–°–¢–ï–ô =====================
    {
        'name': '–ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞',
        'price': 1500.00,
        'duration_minutes': 45,
        'description': '–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)',
        'price': 3000.00,
        'duration_minutes': 90,
        'description': '–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)',
        'price': 2000.00,
        'duration_minutes': 60,
        'description': '–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏',
        'price': 1800.00,
        'duration_minutes': 60,
        'description': '–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏',
        'price': 1200.00,
        'duration_minutes': 45,
        'description': '–ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã'
    },
    
    # ===================== –¢–û–†–ú–û–ó–ù–ê–Ø –°–ò–°–¢–ï–ú–ê =====================
    {
        'name': '–ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫',
        'price': 2500.00,
        'duration_minutes': 90,
        'description': '–ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫',
        'price': 2000.00,
        'duration_minutes': 75,
        'description': '–ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)',
        'price': 4000.00,
        'duration_minutes': 150,
        'description': '–ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤'
    },
    {
        'name': '–ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã',
        'price': 1500.00,
        'duration_minutes': 60,
        'description': '–£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã'
    },
    
    # ===================== –•–û–î–û–í–ê–Ø –ß–ê–°–¢–¨ =====================
    {
        'name': '–ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)',
        'price': 1800.00,
        'duration_minutes': 60,
        'description': '–ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞',
        'price': 1500.00,
        'duration_minutes': 45,
        'description': '–ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤',
        'price': 2200.00,
        'duration_minutes': 90,
        'description': '–ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã',
        'price': 2500.00,
        'duration_minutes': 120,
        'description': '–ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤',
        'price': 3000.00,
        'duration_minutes': 120,
        'description': '–ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏'
    },
    
    # ===================== –°–•–û–î-–†–ê–ó–í–ê–õ =====================
    {
        'name': '–†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)',
        'price': 1500.00,
        'duration_minutes': 45,
        'description': '3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏'
    },
    {
        'name': '–†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)',
        'price': 2500.00,
        'duration_minutes': 75,
        'description': '3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å'
    },
    
    # ===================== –®–ò–ù–û–ú–û–ù–¢–ê–ñ =====================
    {
        'name': '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)',
        'price': 1600.00,
        'duration_minutes': 45,
        'description': '–°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15'
    },
    {
        'name': '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)',
        'price': 2000.00,
        'duration_minutes': 50,
        'description': '–°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17'
    },
    {
        'name': '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)',
        'price': 2500.00,
        'duration_minutes': 60,
        'description': '–°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20'
    },
    {
        'name': '–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)',
        'price': 1200.00,
        'duration_minutes': 40,
        'description': '–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å'
    },
    {
        'name': '–†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)',
        'price': 400.00,
        'duration_minutes': 20,
        'description': '–†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã'
    },
    {
        'name': '–•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)',
        'price': 3000.00,
        'duration_minutes': 30,
        'description': '–°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤'
    },
    
    # ===================== –≠–õ–ï–ö–¢–†–ò–ö–ê =====================
    {
        'name': '–ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞',
        'price': 800.00,
        'duration_minutes': 30,
        'description': '–ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)'
    },
    {
        'name': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏',
        'price': 1500.00,
        'duration_minutes': 60,
        'description': '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è',
        'price': 1200.00,
        'duration_minutes': 45,
        'description': '–ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞',
        'price': 3500.00,
        'duration_minutes': 120,
        'description': '–°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞',
        'price': 3000.00,
        'duration_minutes': 90,
        'description': '–°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞'
    },
    
    # ===================== –î–í–ò–ì–ê–¢–ï–õ–¨ =====================
    {
        'name': '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è',
        'price': 1000.00,
        'duration_minutes': 45,
        'description': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú',
        'price': 6000.00,
        'duration_minutes': 240,
        'description': '–ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú',
        'price': 12000.00,
        'duration_minutes': 360,
        'description': '–ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞',
        'price': 500.00,
        'duration_minutes': 15,
        'description': '–ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞',
        'price': 1200.00,
        'duration_minutes': 45,
        'description': '–ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞',
        'price': 600.00,
        'duration_minutes': 20,
        'description': '–ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)'
    },
    
    # ===================== –í–´–•–õ–û–ü–ù–ê–Ø –°–ò–°–¢–ï–ú–ê =====================
    {
        'name': '–ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è',
        'price': 2500.00,
        'duration_minutes': 90,
        'description': '–ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞',
        'price': 4000.00,
        'duration_minutes': 120,
        'description': '–ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞'
    },
    {
        'name': '–†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã',
        'price': 1800.00,
        'duration_minutes': 60,
        'description': '–†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã'
    },
    
    # ===================== –ö–û–ù–î–ò–¶–ò–û–ù–ï–† =====================
    {
        'name': '–ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞',
        'price': 1500.00,
        'duration_minutes': 60,
        'description': '–ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º'
    },
    {
        'name': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞',
        'price': 800.00,
        'duration_minutes': 45,
        'description': '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å'
    },
    {
        'name': '–ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞',
        'price': 1200.00,
        'duration_minutes': 60,
        'description': '–ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è'
    },
    
    # ===================== –ö–£–ó–û–í–ù–´–ï –†–ê–ë–û–¢–´ =====================
    {
        'name': '–ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞',
        'price': 8000.00,
        'duration_minutes': 480,
        'description': '–ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)'
    },
    {
        'name': '–ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞',
        'price': 5000.00,
        'duration_minutes': 240,
        'description': '–ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è'
    },
    {
        'name': '–†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞',
        'price': 3000.00,
        'duration_minutes': 180,
        'description': '–†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞'
    },
    {
        'name': '–ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞',
        'price': 4000.00,
        'duration_minutes': 120,
        'description': '–°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞'
    },
    
    # ===================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–°–õ–£–ì–ò =====================
    {
        'name': '–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞',
        'price': 800.00,
        'duration_minutes': 45,
        'description': '–ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤'
    },
    {
        'name': '–•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞',
        'price': 4500.00,
        'duration_minutes': 240,
        'description': '–ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è'
    },
    {
        'name': '–≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)',
        'price': 2500.00,
        'duration_minutes': 90,
        'description': '–£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞'
    },
    {
        'name': '–í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞',
        'price': 2000.00,
        'duration_minutes': 120,
        'description': '–í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ'
    },
]


def add_all_services():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö."""
    print("üöó –ù–∞—á–∏–Ω–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≤ –ë–î...\n")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    if not db.test_connection():
        print("‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        return
    
    print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å–ø–µ—à–Ω–æ\n")
    
    # –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏
    success_count = 0
    error_count = 0
    
    for i, service in enumerate(AUTOSERVICE_SERVICES, 1):
        try:
            service_id = db.add_service(
                name=service['name'],
                price=service['price'],
                duration_minutes=service['duration_minutes'],
                description=service['description']
            )
            print(f"‚úÖ [{i}/{len(AUTOSERVICE_SERVICES)}] –î–æ–±–∞–≤–ª–µ–Ω–æ: {service['name']} (ID: {service_id})")
            success_count += 1
        except Exception as e:
            print(f"‚ùå [{i}/{len(AUTOSERVICE_SERVICES)}] –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ '{service['name']}': {e}")
            error_count += 1
    
    print("\n" + "="*70)
    print(f"üìä –ò–¢–û–ì–ò:")
    print(f"   ‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ: {success_count}")
    print(f"   ‚ùå –û—à–∏–±–æ–∫: {error_count}")
    print(f"   üìù –í—Å–µ–≥–æ —É—Å–ª—É–≥: {len(AUTOSERVICE_SERVICES)}")
    print("="*70)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    stats = db.get_stats()
    print(f"\nüìà –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã:")
    print(f"   –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
    print(f"   –£—Å–ª—É–≥: {stats['services_count']}")
    print(f"   –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")


def show_services_by_category():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        '–¢–û': [],
        '–ú–∞—Å–ª–∞': [],
        '–¢–æ—Ä–º–æ–∑–∞': [],
        '–•–æ–¥–æ–≤–∞—è': [],
        '–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '–≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        '–î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        '–í—ã—Ö–ª–æ–ø': [],
        '–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        '–ö—É–∑–æ–≤': [],
        '–ü—Ä–æ—á–µ–µ': []
    }
    
    for service in AUTOSERVICE_SERVICES:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name:
            categories['–¢–û'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç–∏' in name:
            categories['–ú–∞—Å–ª–∞'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['–¢–æ—Ä–º–æ–∑–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['–•–æ–¥–æ–≤–∞—è'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['–≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–¥–≤–∏–≥–∞—Ç–µ–ª', '–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']):
            categories['–î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['–í—ã—Ö–ª–æ–ø'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['–ö—É–∑–æ–≤'].append(service)
        else:
            categories['–ü—Ä–æ—á–µ–µ'].append(service)
    
    print("\nüìã –£–°–õ–£–ì–ò –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú:\n")
    for category, services in categories.items():
        if services:
            print(f"\n{'='*70}")
            print(f"üîπ {category.upper()} ({len(services)} —É—Å–ª—É–≥)")
            print('='*70)
            for service in services:
                print(f"   ‚Ä¢ {service['name']}")
                print(f"     üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.")


if __name__ == '__main__':
    print("\n" + "="*70)
    print("   üöó –ó–ê–ì–†–£–ó–ö–ê –£–°–õ–£–ì –ê–í–¢–û–°–ï–†–í–ò–°–ê –í –ë–ê–ó–£ –î–ê–ù–ù–´–•")
    print("="*70 + "\n")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —É—Å–ª—É–≥
    show_services_by_category()
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    print("\n" + "="*70)
    response = input("\n‚ùì –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö? (yes/no): ").lower().strip()
    
    if response in ['yes', 'y', '–¥–∞', '–¥']:
        add_all_services()
    else:
        print("\n‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞")

```

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –æ–±–Ω–æ–≤–∏–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞, —á—Ç–æ–±—ã –æ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å—É:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
        "/services ‚Äî —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìä  <b>–ù–ê–®–ò –£–°–õ–£–ì–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        
        for service in services:
            text += (
                f"üîπ <b>{service['name']}</b>\n"
                f"   üí∞ –¶–µ–Ω–∞: {service['price']} —Ä—É–±.\n"
                f"   ‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {service['duration_minutes']} –º–∏–Ω.\n"
            )
            if service['description']:
                text += f"   üìù {service['description']}\n"
            text += "\n"
        
        text += "üìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
        
        bot.reply_to(message, text, parse_mode='HTML')
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("ü§ñ CRM-–±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"üìä –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"üìä –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"üìä –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
    else:
        print("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
    
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìä  <b>–ù–ê–®–ò –£–°–õ–£–ì–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        
        for service in services:
            text += (
                f"üîπ <b>{service['name']}</b>\n"
                f"   üí∞ –¶–µ–Ω–∞: {service['price']} —Ä—É–±.\n"
                f"   ‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {service['duration_minutes']} –º–∏–Ω.\n"
            )
            if service['description']:
                text += f"   üìù {service['description']}\n"
            text += "\n"
        
        text += "üìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
        
        bot.reply_to(message, text, parse_mode='HTML')
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("ü§ñ CRM-–±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"üìä –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"üìä –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"üìä –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
    else:
        print("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
    
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        
        for service in services:
            text += (
                f"üîπ <b>{service['name']}</b>\n"
                f"   üí∞ –¶–µ–Ω–∞: {service['price']} —Ä—É–±.\n"
                f"   ‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {service['duration_minutes']} –º–∏–Ω.\n"
            )
            if service['description']:
                text += f"   üìù {service['description']}\n"
            text += "\n"
        
        text += "üìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
        
        bot.reply_to(message, text, parse_mode='HTML')
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("ü§ñ CRM-–±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"üìä –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"üìä –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"üìä –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
    else:
        print("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
    
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        
        for service in services:
            text += (
                f"üîπ <b>{service['name']}</b>\n"
                f"   üí∞ –¶–µ–Ω–∞: {service['price']} —Ä—É–±.\n"
                f"   ‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {service['duration_minutes']} –º–∏–Ω.\n"
            )
            if service['description']:
                text += f"   üìù {service['description']}\n"
            text += "\n"
        
        text += "üìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
        
        bot.reply_to(message, text, parse_mode='HTML')
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö —É—Å–ª—É–≥:

```markdown
# üöó –£—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –¥–ª—è CRM-–±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- [–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π](#–∑–∞–º–µ–Ω–∞-–º–∞—Å–µ–ª-–∏-–∂–∏–¥–∫–æ—Å—Ç–µ–π)
- [–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#—Ç–æ—Ä–º–æ–∑–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å](#—Ö–æ–¥–æ–≤–∞—è-—á–∞—Å—Ç—å)
- [–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª](#—Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª)
- [–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂](#—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)
- [–≠–ª–µ–∫—Ç—Ä–∏–∫–∞](#—ç–ª–µ–∫—Ç—Ä–∏–∫–∞)
- [–î–≤–∏–≥–∞—Ç–µ–ª—å](#–¥–≤–∏–≥–∞—Ç–µ–ª—å)
- [–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#–≤—ã—Ö–ª–æ–ø–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä](#–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä)
- [–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã](#–∫—É–∑–æ–≤–Ω—ã–µ-—Ä–∞–±–æ—Ç—ã)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—É—Å–ª—É–≥–∏)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –¢–û-2 (30 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 7,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤

### –¢–û-3 (60 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤

### –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 5 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

---

## üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π

### –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

### –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å

### –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤
- **–¶–µ–Ω–∞:** 2,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞

### –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏

### –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏

---

## üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å

---

## üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 1,600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 50 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 40 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å

### –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 400 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤

---

## ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞

### –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

---

## üîß –î–≤–∏–≥–∞—Ç–µ–ª—å

### –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 1,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú
- **–¶–µ–Ω–∞:** 6,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏

### –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 6 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏

### –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)

---

## üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä

### –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å

### –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 8 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)

### –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 5,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞

---

## ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤

### –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞
- **–¶–µ–Ω–∞:** 4,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞

### –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 53

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: 4 —É—Å–ª—É–≥–∏
- –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏: 5 —É—Å–ª—É–≥
- –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 4 —É—Å–ª—É–≥–∏
- –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å: 5 —É—Å–ª—É–≥
- –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª: 2 —É—Å–ª—É–≥–∏
- –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 6 —É—Å–ª—É–≥
- –≠–ª–µ–∫—Ç—Ä–∏–∫–∞: 5 —É—Å–ª—É–≥
- –î–≤–∏–≥–∞—Ç–µ–ª—å: 6 —É—Å–ª—É–≥
- –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 3 —É—Å–ª—É–≥–∏
- –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä: 3 —É—Å–ª—É–≥–∏
- –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: 4 —É—Å–ª—É–≥–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏: 4 —É—Å–ª—É–≥–∏

**–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.

---

## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ó–∞–ø—á–∞—Å—Ç–∏:** –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –ó–∞–ø—á–∞—Å—Ç–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–í—Ä–µ–º—è:** –£–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
3. **–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ù–∞ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π.
4. **–¶–µ–Ω—ã:** –ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2024 –≥–æ–¥–∞.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª**
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67
- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã: –ü–Ω-–ü—Ç 9:00-20:00, –°–±-–í—Å 10:00-18:00
- –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è, 123

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2024*

```

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—é README —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ:

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 53 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª—É–≥: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üìä **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py         # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ requirements.txt    # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îî‚îÄ‚îÄ docs/              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 3. –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥

–£—Å–ª—É–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ—Ä SQL:

```sql
INSERT INTO services (name, price, duration_minutes, description)
VALUES 
    ('–°—Ç—Ä–∏–∂–∫–∞', 1500.00, 60, '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞'),
    ('–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ', 3000.00, 120, '–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å'),
    ('–ú–∞–Ω–∏–∫—é—Ä', 2000.00, 90, '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –º–∞–Ω–∏–∫—é—Ä');
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Neon Dashboard.

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 53 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª—É–≥: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py         # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ requirements.txt    # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îî‚îÄ‚îÄ docs/              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 3. –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥

–£—Å–ª—É–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ—Ä SQL:

```sql
INSERT INTO services (name, price, duration_minutes, description)
VALUES 
    ('–°—Ç—Ä–∏–∂–∫–∞', 1500.00, 60, '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞'),
    ('–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ', 3000.00, 120, '–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å'),
    ('–ú–∞–Ω–∏–∫—é—Ä', 2000.00, 90, '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –º–∞–Ω–∏–∫—é—Ä');
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Neon Dashboard.

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 53 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª—É–≥: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 3. –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥

–£—Å–ª—É–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ—Ä SQL:

```sql
INSERT INTO services (name, price, duration_minutes, description)
VALUES 
    ('–°—Ç—Ä–∏–∂–∫–∞', 1500.00, 60, '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞'),
    ('–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ', 3000.00, 120, '–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å'),
    ('–ú–∞–Ω–∏–∫—é—Ä', 2000.00, 90, '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –º–∞–Ω–∏–∫—é—Ä');
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Neon Dashboard.

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 53 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª—É–≥: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥

–£—Å–ª—É–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ—Ä SQL:

```sql
INSERT INTO services (name, price, duration_minutes, description)
VALUES 
    ('–°—Ç—Ä–∏–∂–∫–∞', 1500.00, 60, '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞'),
    ('–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ', 3000.00, 120, '–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å'),
    ('–ú–∞–Ω–∏–∫—é—Ä', 2000.00, 90, '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –º–∞–Ω–∏–∫—é—Ä');
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Neon Dashboard.

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 53 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª—É–≥: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–ë–æ—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ **53 —É—Å–ª—É–≥**:

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:

- üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è **–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π**
- üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å**
- üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª**
- üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**
- ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- üîß **–†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è**
- üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä**
- üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
- ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏**

**–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:** [AUTOSERVICE_SERVICES.md](AUTOSERVICE_SERVICES.md)

### –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥:

```bash
python add_autoservice_services.py
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥:

```python
from database import db

db.add_service(
    name="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",
    price=2500.00,
    duration_minutes=120,
    description="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
)
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É —É—Å–ª—É–≥:

–ü–æ–Ω–∏–º–∞—é! –î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–º –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é. –í–æ—Ç —á—Ç–æ —è —Å–¥–µ–ª–∞–ª:

## ‚úÖ –ì–æ—Ç–æ–≤–æ! –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

### üìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

1. **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥** - `add_autoservice_services.py`
   - 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
   - –†–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ 12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - –° —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

2. **–û–±–Ω–æ–≤–ª—ë–Ω –±–æ—Ç** - `bot.py`
   - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –ø—Ä–æ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–ø—Ä–∞–≤–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± —É—Å–ª—É–≥–∞—Ö
   - –£–ª—É—á—à–µ–Ω –≤—ã–≤–æ–¥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

3. **–°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - `AUTOSERVICE_SERVICES.md`
   - –ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –≤—Å–µ—Ö 53 —É—Å–ª—É–≥
   - –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –¶–µ–Ω—ã –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

4. **–û–±–Ω–æ–≤–ª—ë–Ω README.md**
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å–ª—É–≥–∞—Ö –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

### üöó –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

```plaintext
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                –ö–ê–¢–ê–õ–û–ì –£–°–õ–£–ì –ê–í–¢–û–°–ï–†–í–ò–°–ê ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìä –í–°–ï–ì–û –£–°–õ–£–ì: 53

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üîß –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–ï (4 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º) - 3,500 —Ä—É–±. | 2 —á–∞—Å–∞
   ‚Ä¢ –¢–û-2 (30 —Ç—ã—Å. –∫–º) - 7,500 —Ä—É–±. | 3 —á–∞—Å–∞
   ‚Ä¢ –¢–û-3 (60 —Ç—ã—Å. –∫–º) - 12,000 —Ä—É–±. | 4 —á–∞—Å–∞
   ‚Ä¢ –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ - 8,000 —Ä—É–±. | 5 —á–∞—Å–æ–≤

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üõ¢Ô∏è –ó–ê–ú–ï–ù–ê –ú–ê–°–ï–õ –ò –ñ–ò–î–ö–û–°–¢–ï–ô (5 —É—Å–ª—É–≥)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞ - 1,500 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü) - 3,000 —Ä—É–±. | 1.5 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü) - 2,000 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏ - 1,800 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ - 1,200 —Ä—É–±. | 45 –º–∏–Ω

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üõë –¢–û–†–ú–û–ó–ù–ê–Ø –°–ò–°–¢–ï–ú–ê (4 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫ - 2,500 —Ä—É–±. | 1.5 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫ - 2,000 —Ä—É–±. | 1 —á–∞—Å 15 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç) - 4,000 —Ä—É–±. | 2.5 —á–∞—Å–∞
   ‚Ä¢ –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã - 1,500 —Ä—É–±. | 1 —á–∞—Å

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üî© –•–û–î–û–í–ê–Ø –ß–ê–°–¢–¨ (5 —É—Å–ª—É–≥)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç) - 1,800 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ - 1,500 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ - 2,200 —Ä—É–±. | 1.5 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã - 2,500 —Ä—É–±. | 2 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ - 3,000 —Ä—É–±. | 2 —á–∞—Å–∞

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üìê –°–•–û–î-–†–ê–ó–í–ê–õ (2 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å) - 1,500 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏) - 2,500 —Ä—É–±. | 1 —á–∞—Å 15 –º–∏–Ω

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöó –®–ò–ù–û–ú–û–ù–¢–ê–ñ (6 —É—Å–ª—É–≥)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞) - 1,600 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞) - 2,000 —Ä—É–±. | 50 –º–∏–Ω
   ‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞) - 2,500 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç) - 1,200 —Ä—É–±. | 40 –º–∏–Ω
   ‚Ä¢ –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç) - 400 —Ä—É–±. | 20 –º–∏–Ω
   ‚Ä¢ –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω) - 3,000 —Ä—É–±. | 30 –º–∏–Ω

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚ö° –≠–õ–ï–ö–¢–†–ò–ö–ê (5 —É—Å–ª—É–≥)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ - 800 —Ä—É–±. | 30 –º–∏–Ω
   ‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏ - 1,500 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è - 1,200 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ - 3,500 —Ä—É–±. | 2 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ - 3,000 —Ä—É–±. | 1.5 —á–∞—Å–∞

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üîß –î–í–ò–ì–ê–¢–ï–õ–¨ (6 —É—Å–ª—É–≥)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è - 1,000 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú - 6,000 —Ä—É–±. | 4 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú - 12,000 —Ä—É–±. | 6 —á–∞—Å–æ–≤
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ - 500 —Ä—É–±. | 15 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ - 1,200 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ - 600 —Ä—É–±. | 20 –º–∏–Ω

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üí® –í–´–•–õ–û–ü–ù–ê–Ø –°–ò–°–¢–ï–ú–ê (3 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è - 2,500 —Ä—É–±. | 1.5 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ - 4,000 —Ä—É–±. | 2 —á–∞—Å–∞
   ‚Ä¢ –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã - 1,800 —Ä—É–±. | 1 —á–∞—Å

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚ùÑÔ∏è –ö–û–ù–î–ò–¶–ò–û–ù–ï–† (3 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ - 1,500 —Ä—É–±. | 1 —á–∞—Å
   ‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ - 800 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ - 1,200 —Ä—É–±. | 1 —á–∞—Å

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üé® –ö–£–ó–û–í–ù–´–ï –†–ê–ë–û–¢–´ (4 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ - 8,000 —Ä—É–±. | 8 —á–∞—Å–æ–≤
   ‚Ä¢ –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ - 5,000 —Ä—É–±. | 4 —á–∞—Å–∞
   ‚Ä¢ –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ - 3,000 —Ä—É–±. | 3 —á–∞—Å–∞
   ‚Ä¢ –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞ - 4,000 —Ä—É–±. | 2 —á–∞—Å–∞

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚ûï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–°–õ–£–ì–ò (4 —É—Å–ª—É–≥–∏)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ‚Ä¢ –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞ - 800 —Ä—É–±. | 45 –º–∏–Ω
   ‚Ä¢ –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ - 4,500 —Ä—É–±. | 4 —á–∞—Å–∞
   ‚Ä¢ –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É) - 2,500 —Ä—É–±. | 1.5 —á–∞—Å–∞
   ‚Ä¢ –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ - 2,000 —Ä—É–±. | 2 —á–∞—Å–∞

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üí∞ –¶–ï–ù–û–í–û–ô –î–ò–ê–ü–ê–ó–û–ù: –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.
‚è±Ô∏è  –í–†–ï–ú–Ø –í–´–ü–û–õ–ù–ï–ù–ò–Ø: –æ—Ç 15 –º–∏–Ω—É—Ç –¥–æ 8 —á–∞—Å–æ–≤

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

```

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –∑–∞–ø—É—Å–∫—É:

```markdown
# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

- ‚úîÔ∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ (`venv/`)
- ‚úîÔ∏è –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úîÔ∏è –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
- ‚úîÔ∏è 53 —É—Å–ª—É–≥–∏ –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–≥—Ä—É–∑–∫–µ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ñ–∞–π–ª `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ì–¥–µ –≤–∑—è—Ç—å:**
- **BOT_TOKEN** ‚Üí [@BotFather](https://t.me/BotFather) –≤ Telegram
- **DATABASE_URL** ‚Üí [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

---

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
.\venv\Scripts\python.exe add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:**
- üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π
- üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å
- üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª
- üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6 —É—Å–ª—É–≥)
- ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (—Ñ–∏–ª—å—Ç—Ä—ã, –ì–†–ú –∏ —Ç.–¥.)
- üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä
- üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
.\venv\Scripts\python.exe bot.py
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ

üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: 0
   ‚Ä¢ –£—Å–ª—É–≥: 53
   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: 0

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ (–ø–æ –∏–º–µ–Ω–∏ –∏–∑ BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ `/register`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–ª—É–≥–∏ —á–µ—Ä–µ–∑ `/services`
5. –ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —É—Å–ª—É–≥—É —á–µ—Ä–µ–∑ `/book`

---

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/services` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —É—Å–ª—É–≥
- `/book` ‚Äî –∑–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- `DATABASE_API.md` ‚Äî API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `README.md` ‚Äî –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `SETUP.md` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É

```python
from database import db

db.add_service(
    name="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏",
    price=5000.00,
    duration_minutes=180,
    description="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏

```python
from database import db

services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `BOT_TOKEN` –∏ `DATABASE_URL`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ

### –ù–µ—Ç —É—Å–ª—É–≥ –≤ –±–æ—Ç–µ
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python add_autoservice_services.py`
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É (–≤–≤–µ–¥–∏—Ç–µ "yes")

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ —Ñ–∞–π–ª–µ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ Neon.tech
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –µ—Å—Ç—å `?sslmode=require`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `README.md` –∏ `SETUP.md`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞

---

**–ì–æ—Ç–æ–≤–æ! –í–∞—à –±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöó**

```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏:

–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! ‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤–æ! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥–≤–µ–¥—ë–º –∏—Ç–æ–≥–∏:

---

## üéâ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: –ë–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

### ‚úÖ –ß—Ç–æ —è —Å–¥–µ–ª–∞–ª:

#### 1Ô∏è‚É£ **–°–æ–∑–¥–∞–Ω –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ (53 —É—Å–ª—É–≥–∏)**
   - üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û-1, –¢–û-2, –¢–û-3, –ø—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
   - üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π (5 —É—Å–ª—É–≥)
   - üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (4 —É—Å–ª—É–≥–∏)
   - üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å (5 —É—Å–ª—É–≥)
   - üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª (2 —É—Å–ª—É–≥–∏)
   - üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ (6 —É—Å–ª—É–≥)
   - ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (5 —É—Å–ª—É–≥)
   - üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (6 —É—Å–ª—É–≥ - —Ñ–∏–ª—å—Ç—Ä—ã, –ì–†–ú –∏ —Ç.–¥.)
   - üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (3 —É—Å–ª—É–≥–∏)
   - ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä (3 —É—Å–ª—É–≥–∏)
   - üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (4 —É—Å–ª—É–≥–∏)
   - ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ (–º–æ–π–∫–∞, —Ö–∏–º—á–∏—Å—Ç–∫–∞, —ç–≤–∞–∫—É–∞—Ç–æ—Ä –∏ —Ç.–¥.)

#### 2Ô∏è‚É£ **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥**
   - –§–∞–π–ª: `add_autoservice_services.py`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –≤ –ë–î
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

#### 3Ô∏è‚É£ **–û–±–Ω–æ–≤–ª—ë–Ω –±–æ—Ç –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞**
   - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/help` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± —É—Å–ª—É–≥–∞—Ö
   - –£–ª—É—á—à–µ–Ω –≤—ã–≤–æ–¥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —É—Å–ª—É–≥

#### 4Ô∏è‚É£ **–°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
   - `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –≤—Å–µ—Ö —É—Å–ª—É–≥ —Å —Ü–µ–Ω–∞–º–∏
   - `QUICK_START.md` ‚Äî –±—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
   - –û–±–Ω–æ–≤–ª—ë–Ω `README.md` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `.env`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç:
```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname
```

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å–ª—É–≥–∏ –≤ –ë–î

```bash
.\venv\Scripts\python.exe add_autoservice_services.py
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
.\venv\Scripts\python.exe bot.py
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

- **–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 53
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–π:** 12
- **–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** 400 ‚ÇΩ ‚Äî 12,000 ‚ÇΩ
- **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç:** –æ—Ç 15 –º–∏–Ω—É—Ç –¥–æ 8 —á–∞—Å–æ–≤

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

‚úÖ `add_autoservice_services.py` ‚Äî —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥  
‚úÖ `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥  
‚úÖ `QUICK_START.md` ‚Äî –±—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è  
‚úÖ `bot.py` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞  
‚úÖ `README.md` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ

---

–í–∞—à –±–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöó –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ! üéâ

```plaintext
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname
```

```shellscript
.\venv\Scripts\python.exe add_autoservice_services.py
```

```shellscript
.\venv\Scripts\python.exe bot.py
```

---

**User**

@AUTOSERVICE_SERVICES.md:377 –æ–¥–Ω–æ –∑–∞–º–µ—á–∞–Ω–∏–µ: —Å–µ–≥–æ–¥–Ω—è 3 –¥–µ–∫–∞–±—Ä—è 2025. –ü—Ä–æ–≤–µ—Ä—å –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∏—Å–ø—Ä–∞–≤—å –¥–∞—Ç—ã

---

**Cursor**

–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–º–µ—á–∞–Ω–∏–µ! –ò—Å–ø—Ä–∞–≤–ª—é –¥–∞—Ç—ã –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö —Å 2024 –Ω–∞ 2025.

–ù–∞—à–µ–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏. –°–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é:

```markdown
# üöó –£—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –¥–ª—è CRM-–±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- [–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π](#–∑–∞–º–µ–Ω–∞-–º–∞—Å–µ–ª-–∏-–∂–∏–¥–∫–æ—Å—Ç–µ–π)
- [–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#—Ç–æ—Ä–º–æ–∑–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å](#—Ö–æ–¥–æ–≤–∞—è-—á–∞—Å—Ç—å)
- [–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª](#—Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª)
- [–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂](#—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)
- [–≠–ª–µ–∫—Ç—Ä–∏–∫–∞](#—ç–ª–µ–∫—Ç—Ä–∏–∫–∞)
- [–î–≤–∏–≥–∞—Ç–µ–ª—å](#–¥–≤–∏–≥–∞—Ç–µ–ª—å)
- [–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#–≤—ã—Ö–ª–æ–ø–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä](#–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä)
- [–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã](#–∫—É–∑–æ–≤–Ω—ã–µ-—Ä–∞–±–æ—Ç—ã)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—É—Å–ª—É–≥–∏)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –¢–û-2 (30 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 7,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤

### –¢–û-3 (60 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤

### –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 5 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

---

## üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π

### –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

### –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å

### –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤
- **–¶–µ–Ω–∞:** 2,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞

### –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏

### –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏

---

## üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å

---

## üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 1,600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 50 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 40 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å

### –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 400 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤

---

## ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞

### –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

---

## üîß –î–≤–∏–≥–∞—Ç–µ–ª—å

### –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 1,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú
- **–¶–µ–Ω–∞:** 6,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏

### –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 6 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏

### –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)

---

## üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä

### –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å

### –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 8 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)

### –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 5,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞

---

## ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤

### –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞
- **–¶–µ–Ω–∞:** 4,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞

### –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 53

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: 4 —É—Å–ª—É–≥–∏
- –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏: 5 —É—Å–ª—É–≥
- –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 4 —É—Å–ª—É–≥–∏
- –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å: 5 —É—Å–ª—É–≥
- –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª: 2 —É—Å–ª—É–≥–∏
- –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 6 —É—Å–ª—É–≥
- –≠–ª–µ–∫—Ç—Ä–∏–∫–∞: 5 —É—Å–ª—É–≥
- –î–≤–∏–≥–∞—Ç–µ–ª—å: 6 —É—Å–ª—É–≥
- –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 3 —É—Å–ª—É–≥–∏
- –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä: 3 —É—Å–ª—É–≥–∏
- –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: 4 —É—Å–ª—É–≥–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏: 4 —É—Å–ª—É–≥–∏

**–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.

---

## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ó–∞–ø—á–∞—Å—Ç–∏:** –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –ó–∞–ø—á–∞—Å—Ç–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–í—Ä–µ–º—è:** –£–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
3. **–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ù–∞ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π.
4. **–¶–µ–Ω—ã:** –ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025 –≥–æ–¥–∞.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª**
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67
- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã: –ü–Ω-–ü—Ç 9:00-20:00, –°–±-–í—Å 10:00-18:00
- –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è, 123

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2024*


```

```markdown
# üöó –£—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –¥–ª—è CRM-–±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- [–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π](#–∑–∞–º–µ–Ω–∞-–º–∞—Å–µ–ª-–∏-–∂–∏–¥–∫–æ—Å—Ç–µ–π)
- [–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#—Ç–æ—Ä–º–æ–∑–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å](#—Ö–æ–¥–æ–≤–∞—è-—á–∞—Å—Ç—å)
- [–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª](#—Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª)
- [–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂](#—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)
- [–≠–ª–µ–∫—Ç—Ä–∏–∫–∞](#—ç–ª–µ–∫—Ç—Ä–∏–∫–∞)
- [–î–≤–∏–≥–∞—Ç–µ–ª—å](#–¥–≤–∏–≥–∞—Ç–µ–ª—å)
- [–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#–≤—ã—Ö–ª–æ–ø–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä](#–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä)
- [–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã](#–∫—É–∑–æ–≤–Ω—ã–µ-—Ä–∞–±–æ—Ç—ã)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—É—Å–ª—É–≥–∏)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –¢–û-2 (30 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 7,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤

### –¢–û-3 (60 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤

### –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 5 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

---

## üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π

### –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

### –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å

### –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤
- **–¶–µ–Ω–∞:** 2,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞

### –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏

### –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏

---

## üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å

---

## üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 1,600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 50 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 40 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å

### –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 400 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤

---

## ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞

### –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

---

## üîß –î–≤–∏–≥–∞—Ç–µ–ª—å

### –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 1,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú
- **–¶–µ–Ω–∞:** 6,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏

### –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 6 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏

### –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)

---

## üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä

### –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å

### –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 8 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)

### –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 5,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞

---

## ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤

### –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞
- **–¶–µ–Ω–∞:** 4,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞

### –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 53

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: 4 —É—Å–ª—É–≥–∏
- –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏: 5 —É—Å–ª—É–≥
- –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 4 —É—Å–ª—É–≥–∏
- –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å: 5 —É—Å–ª—É–≥
- –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª: 2 —É—Å–ª—É–≥–∏
- –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 6 —É—Å–ª—É–≥
- –≠–ª–µ–∫—Ç—Ä–∏–∫–∞: 5 —É—Å–ª—É–≥
- –î–≤–∏–≥–∞—Ç–µ–ª—å: 6 —É—Å–ª—É–≥
- –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 3 —É—Å–ª—É–≥–∏
- –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä: 3 —É—Å–ª—É–≥–∏
- –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: 4 —É—Å–ª—É–≥–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏: 4 —É—Å–ª—É–≥–∏

**–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.

---

## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ó–∞–ø—á–∞—Å—Ç–∏:** –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –ó–∞–ø—á–∞—Å—Ç–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–í—Ä–µ–º—è:** –£–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
3. **–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ù–∞ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π.
4. **–¶–µ–Ω—ã:** –ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025 –≥–æ–¥–∞.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª**
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67
- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã: –ü–Ω-–ü—Ç 9:00-20:00, –°–±-–í—Å 10:00-18:00
- –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è, 123

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2025*


```

```markdown
# üóÑ API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º –∫–ª–∞—Å—Å–∞ `Database` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
- [–ö–ª–∏–µ–Ω—Ç—ã (Clients)](#–∫–ª–∏–µ–Ω—Ç—ã-clients)
- [–£—Å–ª—É–≥–∏ (Services)](#—É—Å–ª—É–≥–∏-services)
- [–ó–∞–ø–∏—Å–∏ (Appointments)](#–∑–∞–ø–∏—Å–∏-appointments)
- [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### `test_connection() -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```python
if db.test_connection():
    print("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ")
```

---

## –ö–ª–∏–µ–Ω—Ç—ã (Clients)

### `get_client_by_telegram_id(telegram_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ Telegram ID.

```python
client = db.get_client_by_telegram_id(123456789)
if client:
    print(f"–ö–ª–∏–µ–Ω—Ç: {client['name']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'id': 1,
    'name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    'phone': '+7 900 123-45-67',
    'telegram_id': 123456789,
    'notes': None,
    'created_at': datetime(2025, 1, 1, 12, 0, 0)
}
```

### `get_client_by_id(client_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ ID.

```python
client = db.get_client_by_id(1)
```

### `add_client(name: str, phone: str, telegram_id: int, notes: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

```python
client_id = db.add_client(
    name="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    phone="+7 900 123-45-67",
    telegram_id=123456789,
    notes="VIP –∫–ª–∏–µ–Ω—Ç"
)
print(f"–°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç ID: {client_id}")
```

### `update_client(client_id: int, **kwargs) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞.

```python
success = db.update_client(
    client_id=1,
    phone="+7 900 999-99-99",
    notes="–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏"
)
```

### `get_all_clients(limit: int = 100) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100).

```python
clients = db.get_all_clients(limit=50)
for client in clients:
    print(client['name'])
```

---

## –£—Å–ª—É–≥–∏ (Services)

### `get_all_services(active_only: bool = True) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥.

```python
# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
services = db.get_all_services()

# –í—Å–µ —É—Å–ª—É–≥–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
all_services = db.get_all_services(active_only=False)
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'name': '–°—Ç—Ä–∏–∂–∫–∞',
        'price': Decimal('1500.00'),
        'duration_minutes': 60,
        'description': '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞',
        'is_active': True,
        'created_at': datetime(2024, 1, 1, 10, 0, 0)
    },
    ...
]
```

### `get_service_by_id(service_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —É—Å–ª—É–≥—É –ø–æ ID.

```python
service = db.get_service_by_id(1)
print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

### `add_service(name: str, price: float, duration_minutes: int = 60, description: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —É—Å–ª—É–≥—É.

```python
service_id = db.add_service(
    name="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ",
    price=3000.00,
    duration_minutes=120,
    description="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å"
)
```

---

## –ó–∞–ø–∏—Å–∏ (Appointments)

### `add_appointment(client_id: int, service_id: int, appointment_datetime: datetime, comment: str = None) -> int`

–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

```python
from datetime import datetime

appointment_id = db.add_appointment(
    client_id=1,
    service_id=1,
    appointment_datetime=datetime(2024, 12, 15, 14, 30),
    comment="–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É"
)
```

### `get_client_appointments(client_id: int, status: str = None) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞.

```python
# –í—Å–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id=1)

# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
pending = db.get_client_appointments(client_id=1, status='pending')
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'client_id': 1,
        'service_id': 1,
        'appointment_datetime': datetime(2024, 12, 15, 14, 30),
        'status': 'pending',
        'comment': '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É',
        'created_at': datetime(2024, 12, 1, 10, 0, 0),
        'service_name': '–°—Ç—Ä–∏–∂–∫–∞',  # JOIN —Å services
        'price': Decimal('1500.00')
    },
    ...
]
```

### `update_appointment_status(appointment_id: int, status: str) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏.

```python
# –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å
db.update_appointment_status(appointment_id=1, status='confirmed')

# –ó–∞–≤–µ—Ä—à–∏—Ç—å
db.update_appointment_status(appointment_id=1, status='completed')
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### `cancel_appointment(appointment_id: int) -> bool`

–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è `update_appointment_status`).

```python
success = db.cancel_appointment(appointment_id=1)
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `get_stats() -> dict`

–ü–æ–ª—É—á–∞–µ—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã.

```python
stats = db.get_stats()
print(f"–ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
print(f"–£—Å–ª—É–≥: {stats['services_count']}")
print(f"–ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
print(f"–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º: {stats['appointments_by_status']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'clients_count': 150,
    'services_count': 10,
    'appointments_count': 450,
    'appointments_by_status': {
        'pending': 25,
        'confirmed': 50,
        'completed': 350,
        'cancelled': 25
    }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º

```python
from database import db
from datetime import datetime, timedelta

# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client_id = db.add_client(
    name="–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
    phone="+7 900 555-55-55",
    telegram_id=987654321
)

# 2. –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
tomorrow = datetime.now() + timedelta(days=1)
appointment_time = tomorrow.replace(hour=14, minute=0, second=0)

appointment_id = db.add_appointment(
    client_id=client_id,
    service_id=services[0]['id'],
    appointment_datetime=appointment_time
)

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id)
for app in appointments:
    print(f"–ó–∞–ø–∏—Å—å #{app['id']}: {app['service_name']} - {app['appointment_datetime']}")

# 5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
db.update_appointment_status(appointment_id, 'confirmed')

# 6. –ü–æ—Å–ª–µ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥–∏
db.update_appointment_status(appointment_id, 'completed')

# 7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = db.get_stats()
print(f"–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
```

### –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

```python
from datetime import datetime, timedelta

def get_available_slots(service_id: int, date: datetime) -> list:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –¥–∞—Ç—É."""
    # –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ database.py
    # –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
    
    all_slots = [
        datetime.combine(date, datetime.strptime(t, "%H:%M").time())
        for t in ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00"]
    ]
    
    # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∏–∑ –ë–î
    # busy_slots = db.get_busy_slots(service_id, date)
    # available = [s for s in all_slots if s not in busy_slots]
    
    return all_slots
```

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

–î–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:

### `get_connection()`

```python
with db.get_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM clients")
    results = cursor.fetchall()
```

### `get_cursor(dict_cursor: bool = True)`

```python
with db.get_cursor() as cursor:
    cursor.execute("SELECT * FROM services WHERE price > %s", (1000,))
    expensive_services = cursor.fetchall()
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î:

```python
try:
    client_id = db.add_client(
        name="Test",
        phone="+7 900 111-11-11",
        telegram_id=111111111
    )
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- `psycopg2.IntegrityError` ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏–∫–∞—Ç telegram_id)
- `psycopg2.OperationalError` ‚Äî –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `psycopg2.ProgrammingError` ‚Äî –æ—à–∏–±–∫–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞

---

## SQL-—Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü

### clients
```sql
CREATE TABLE clients (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    phone VARCHAR(50),
    telegram_id BIGINT UNIQUE,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### services
```sql
CREATE TABLE services (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    duration_minutes INTEGER DEFAULT 60,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### appointments
```sql
CREATE TABLE appointments (
    id SERIAL PRIMARY KEY,
    client_id INTEGER NOT NULL REFERENCES clients(id) ON DELETE CASCADE,
    service_id INTEGER NOT NULL REFERENCES services(id),
    appointment_datetime TIMESTAMP NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```


```

```markdown
# üóÑ API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º –∫–ª–∞—Å—Å–∞ `Database` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
- [–ö–ª–∏–µ–Ω—Ç—ã (Clients)](#–∫–ª–∏–µ–Ω—Ç—ã-clients)
- [–£—Å–ª—É–≥–∏ (Services)](#—É—Å–ª—É–≥–∏-services)
- [–ó–∞–ø–∏—Å–∏ (Appointments)](#–∑–∞–ø–∏—Å–∏-appointments)
- [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### `test_connection() -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```python
if db.test_connection():
    print("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ")
```

---

## –ö–ª–∏–µ–Ω—Ç—ã (Clients)

### `get_client_by_telegram_id(telegram_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ Telegram ID.

```python
client = db.get_client_by_telegram_id(123456789)
if client:
    print(f"–ö–ª–∏–µ–Ω—Ç: {client['name']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'id': 1,
    'name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    'phone': '+7 900 123-45-67',
    'telegram_id': 123456789,
    'notes': None,
    'created_at': datetime(2025, 1, 1, 12, 0, 0)
}
```

### `get_client_by_id(client_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ ID.

```python
client = db.get_client_by_id(1)
```

### `add_client(name: str, phone: str, telegram_id: int, notes: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

```python
client_id = db.add_client(
    name="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    phone="+7 900 123-45-67",
    telegram_id=123456789,
    notes="VIP –∫–ª–∏–µ–Ω—Ç"
)
print(f"–°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç ID: {client_id}")
```

### `update_client(client_id: int, **kwargs) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞.

```python
success = db.update_client(
    client_id=1,
    phone="+7 900 999-99-99",
    notes="–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏"
)
```

### `get_all_clients(limit: int = 100) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100).

```python
clients = db.get_all_clients(limit=50)
for client in clients:
    print(client['name'])
```

---

## –£—Å–ª—É–≥–∏ (Services)

### `get_all_services(active_only: bool = True) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥.

```python
# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
services = db.get_all_services()

# –í—Å–µ —É—Å–ª—É–≥–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
all_services = db.get_all_services(active_only=False)
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'name': '–°—Ç—Ä–∏–∂–∫–∞',
        'price': Decimal('1500.00'),
        'duration_minutes': 60,
        'description': '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞',
        'is_active': True,
        'created_at': datetime(2025, 1, 1, 10, 0, 0)
    },
    ...
]
```

### `get_service_by_id(service_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —É—Å–ª—É–≥—É –ø–æ ID.

```python
service = db.get_service_by_id(1)
print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

### `add_service(name: str, price: float, duration_minutes: int = 60, description: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —É—Å–ª—É–≥—É.

```python
service_id = db.add_service(
    name="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ",
    price=3000.00,
    duration_minutes=120,
    description="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å"
)
```

---

## –ó–∞–ø–∏—Å–∏ (Appointments)

### `add_appointment(client_id: int, service_id: int, appointment_datetime: datetime, comment: str = None) -> int`

–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

```python
from datetime import datetime

appointment_id = db.add_appointment(
    client_id=1,
    service_id=1,
    appointment_datetime=datetime(2024, 12, 15, 14, 30),
    comment="–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É"
)
```

### `get_client_appointments(client_id: int, status: str = None) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞.

```python
# –í—Å–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id=1)

# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
pending = db.get_client_appointments(client_id=1, status='pending')
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'client_id': 1,
        'service_id': 1,
        'appointment_datetime': datetime(2024, 12, 15, 14, 30),
        'status': 'pending',
        'comment': '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É',
        'created_at': datetime(2024, 12, 1, 10, 0, 0),
        'service_name': '–°—Ç—Ä–∏–∂–∫–∞',  # JOIN —Å services
        'price': Decimal('1500.00')
    },
    ...
]
```

### `update_appointment_status(appointment_id: int, status: str) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏.

```python
# –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å
db.update_appointment_status(appointment_id=1, status='confirmed')

# –ó–∞–≤–µ—Ä—à–∏—Ç—å
db.update_appointment_status(appointment_id=1, status='completed')
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### `cancel_appointment(appointment_id: int) -> bool`

–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è `update_appointment_status`).

```python
success = db.cancel_appointment(appointment_id=1)
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `get_stats() -> dict`

–ü–æ–ª—É—á–∞–µ—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã.

```python
stats = db.get_stats()
print(f"–ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
print(f"–£—Å–ª—É–≥: {stats['services_count']}")
print(f"–ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
print(f"–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º: {stats['appointments_by_status']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'clients_count': 150,
    'services_count': 10,
    'appointments_count': 450,
    'appointments_by_status': {
        'pending': 25,
        'confirmed': 50,
        'completed': 350,
        'cancelled': 25
    }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º

```python
from database import db
from datetime import datetime, timedelta

# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client_id = db.add_client(
    name="–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
    phone="+7 900 555-55-55",
    telegram_id=987654321
)

# 2. –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
tomorrow = datetime.now() + timedelta(days=1)
appointment_time = tomorrow.replace(hour=14, minute=0, second=0)

appointment_id = db.add_appointment(
    client_id=client_id,
    service_id=services[0]['id'],
    appointment_datetime=appointment_time
)

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id)
for app in appointments:
    print(f"–ó–∞–ø–∏—Å—å #{app['id']}: {app['service_name']} - {app['appointment_datetime']}")

# 5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
db.update_appointment_status(appointment_id, 'confirmed')

# 6. –ü–æ—Å–ª–µ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥–∏
db.update_appointment_status(appointment_id, 'completed')

# 7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = db.get_stats()
print(f"–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
```

### –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

```python
from datetime import datetime, timedelta

def get_available_slots(service_id: int, date: datetime) -> list:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –¥–∞—Ç—É."""
    # –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ database.py
    # –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
    
    all_slots = [
        datetime.combine(date, datetime.strptime(t, "%H:%M").time())
        for t in ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00"]
    ]
    
    # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∏–∑ –ë–î
    # busy_slots = db.get_busy_slots(service_id, date)
    # available = [s for s in all_slots if s not in busy_slots]
    
    return all_slots
```

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

–î–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:

### `get_connection()`

```python
with db.get_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM clients")
    results = cursor.fetchall()
```

### `get_cursor(dict_cursor: bool = True)`

```python
with db.get_cursor() as cursor:
    cursor.execute("SELECT * FROM services WHERE price > %s", (1000,))
    expensive_services = cursor.fetchall()
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î:

```python
try:
    client_id = db.add_client(
        name="Test",
        phone="+7 900 111-11-11",
        telegram_id=111111111
    )
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- `psycopg2.IntegrityError` ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏–∫–∞—Ç telegram_id)
- `psycopg2.OperationalError` ‚Äî –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `psycopg2.ProgrammingError` ‚Äî –æ—à–∏–±–∫–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞

---

## SQL-—Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü

### clients
```sql
CREATE TABLE clients (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    phone VARCHAR(50),
    telegram_id BIGINT UNIQUE,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### services
```sql
CREATE TABLE services (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    duration_minutes INTEGER DEFAULT 60,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### appointments
```sql
CREATE TABLE appointments (
    id SERIAL PRIMARY KEY,
    client_id INTEGER NOT NULL REFERENCES clients(id) ON DELETE CASCADE,
    service_id INTEGER NOT NULL REFERENCES services(id),
    appointment_datetime TIMESTAMP NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```


```

```markdown
# üóÑ API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º –∫–ª–∞—Å—Å–∞ `Database` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
- [–ö–ª–∏–µ–Ω—Ç—ã (Clients)](#–∫–ª–∏–µ–Ω—Ç—ã-clients)
- [–£—Å–ª—É–≥–∏ (Services)](#—É—Å–ª—É–≥–∏-services)
- [–ó–∞–ø–∏—Å–∏ (Appointments)](#–∑–∞–ø–∏—Å–∏-appointments)
- [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### `test_connection() -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```python
if db.test_connection():
    print("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ")
```

---

## –ö–ª–∏–µ–Ω—Ç—ã (Clients)

### `get_client_by_telegram_id(telegram_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ Telegram ID.

```python
client = db.get_client_by_telegram_id(123456789)
if client:
    print(f"–ö–ª–∏–µ–Ω—Ç: {client['name']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'id': 1,
    'name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    'phone': '+7 900 123-45-67',
    'telegram_id': 123456789,
    'notes': None,
    'created_at': datetime(2025, 1, 1, 12, 0, 0)
}
```

### `get_client_by_id(client_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ ID.

```python
client = db.get_client_by_id(1)
```

### `add_client(name: str, phone: str, telegram_id: int, notes: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

```python
client_id = db.add_client(
    name="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    phone="+7 900 123-45-67",
    telegram_id=123456789,
    notes="VIP –∫–ª–∏–µ–Ω—Ç"
)
print(f"–°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç ID: {client_id}")
```

### `update_client(client_id: int, **kwargs) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞.

```python
success = db.update_client(
    client_id=1,
    phone="+7 900 999-99-99",
    notes="–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏"
)
```

### `get_all_clients(limit: int = 100) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100).

```python
clients = db.get_all_clients(limit=50)
for client in clients:
    print(client['name'])
```

---

## –£—Å–ª—É–≥–∏ (Services)

### `get_all_services(active_only: bool = True) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥.

```python
# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
services = db.get_all_services()

# –í—Å–µ —É—Å–ª—É–≥–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
all_services = db.get_all_services(active_only=False)
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'name': '–°—Ç—Ä–∏–∂–∫–∞',
        'price': Decimal('1500.00'),
        'duration_minutes': 60,
        'description': '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞',
        'is_active': True,
        'created_at': datetime(2025, 1, 1, 10, 0, 0)
    },
    ...
]
```

### `get_service_by_id(service_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —É—Å–ª—É–≥—É –ø–æ ID.

```python
service = db.get_service_by_id(1)
print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

### `add_service(name: str, price: float, duration_minutes: int = 60, description: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —É—Å–ª—É–≥—É.

```python
service_id = db.add_service(
    name="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ",
    price=3000.00,
    duration_minutes=120,
    description="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å"
)
```

---

## –ó–∞–ø–∏—Å–∏ (Appointments)

### `add_appointment(client_id: int, service_id: int, appointment_datetime: datetime, comment: str = None) -> int`

–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

```python
from datetime import datetime

appointment_id = db.add_appointment(
    client_id=1,
    service_id=1,
    appointment_datetime=datetime(2025, 12, 15, 14, 30),
    comment="–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É"
)
```

### `get_client_appointments(client_id: int, status: str = None) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞.

```python
# –í—Å–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id=1)

# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
pending = db.get_client_appointments(client_id=1, status='pending')
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'client_id': 1,
        'service_id': 1,
        'appointment_datetime': datetime(2024, 12, 15, 14, 30),
        'status': 'pending',
        'comment': '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É',
        'created_at': datetime(2024, 12, 1, 10, 0, 0),
        'service_name': '–°—Ç—Ä–∏–∂–∫–∞',  # JOIN —Å services
        'price': Decimal('1500.00')
    },
    ...
]
```

### `update_appointment_status(appointment_id: int, status: str) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏.

```python
# –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å
db.update_appointment_status(appointment_id=1, status='confirmed')

# –ó–∞–≤–µ—Ä—à–∏—Ç—å
db.update_appointment_status(appointment_id=1, status='completed')
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### `cancel_appointment(appointment_id: int) -> bool`

–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è `update_appointment_status`).

```python
success = db.cancel_appointment(appointment_id=1)
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `get_stats() -> dict`

–ü–æ–ª—É—á–∞–µ—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã.

```python
stats = db.get_stats()
print(f"–ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
print(f"–£—Å–ª—É–≥: {stats['services_count']}")
print(f"–ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
print(f"–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º: {stats['appointments_by_status']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'clients_count': 150,
    'services_count': 10,
    'appointments_count': 450,
    'appointments_by_status': {
        'pending': 25,
        'confirmed': 50,
        'completed': 350,
        'cancelled': 25
    }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º

```python
from database import db
from datetime import datetime, timedelta

# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client_id = db.add_client(
    name="–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
    phone="+7 900 555-55-55",
    telegram_id=987654321
)

# 2. –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
tomorrow = datetime.now() + timedelta(days=1)
appointment_time = tomorrow.replace(hour=14, minute=0, second=0)

appointment_id = db.add_appointment(
    client_id=client_id,
    service_id=services[0]['id'],
    appointment_datetime=appointment_time
)

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id)
for app in appointments:
    print(f"–ó–∞–ø–∏—Å—å #{app['id']}: {app['service_name']} - {app['appointment_datetime']}")

# 5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
db.update_appointment_status(appointment_id, 'confirmed')

# 6. –ü–æ—Å–ª–µ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥–∏
db.update_appointment_status(appointment_id, 'completed')

# 7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = db.get_stats()
print(f"–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
```

### –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

```python
from datetime import datetime, timedelta

def get_available_slots(service_id: int, date: datetime) -> list:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –¥–∞—Ç—É."""
    # –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ database.py
    # –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
    
    all_slots = [
        datetime.combine(date, datetime.strptime(t, "%H:%M").time())
        for t in ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00"]
    ]
    
    # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∏–∑ –ë–î
    # busy_slots = db.get_busy_slots(service_id, date)
    # available = [s for s in all_slots if s not in busy_slots]
    
    return all_slots
```

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

–î–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:

### `get_connection()`

```python
with db.get_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM clients")
    results = cursor.fetchall()
```

### `get_cursor(dict_cursor: bool = True)`

```python
with db.get_cursor() as cursor:
    cursor.execute("SELECT * FROM services WHERE price > %s", (1000,))
    expensive_services = cursor.fetchall()
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î:

```python
try:
    client_id = db.add_client(
        name="Test",
        phone="+7 900 111-11-11",
        telegram_id=111111111
    )
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- `psycopg2.IntegrityError` ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏–∫–∞—Ç telegram_id)
- `psycopg2.OperationalError` ‚Äî –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `psycopg2.ProgrammingError` ‚Äî –æ—à–∏–±–∫–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞

---

## SQL-—Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü

### clients
```sql
CREATE TABLE clients (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    phone VARCHAR(50),
    telegram_id BIGINT UNIQUE,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### services
```sql
CREATE TABLE services (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    duration_minutes INTEGER DEFAULT 60,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### appointments
```sql
CREATE TABLE appointments (
    id SERIAL PRIMARY KEY,
    client_id INTEGER NOT NULL REFERENCES clients(id) ON DELETE CASCADE,
    service_id INTEGER NOT NULL REFERENCES services(id),
    appointment_datetime TIMESTAMP NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```


```

```markdown
# üóÑ API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º –∫–ª–∞—Å—Å–∞ `Database` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
- [–ö–ª–∏–µ–Ω—Ç—ã (Clients)](#–∫–ª–∏–µ–Ω—Ç—ã-clients)
- [–£—Å–ª—É–≥–∏ (Services)](#—É—Å–ª—É–≥–∏-services)
- [–ó–∞–ø–∏—Å–∏ (Appointments)](#–∑–∞–ø–∏—Å–∏-appointments)
- [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### `test_connection() -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```python
if db.test_connection():
    print("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ")
```

---

## –ö–ª–∏–µ–Ω—Ç—ã (Clients)

### `get_client_by_telegram_id(telegram_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ Telegram ID.

```python
client = db.get_client_by_telegram_id(123456789)
if client:
    print(f"–ö–ª–∏–µ–Ω—Ç: {client['name']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'id': 1,
    'name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    'phone': '+7 900 123-45-67',
    'telegram_id': 123456789,
    'notes': None,
    'created_at': datetime(2025, 1, 1, 12, 0, 0)
}
```

### `get_client_by_id(client_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ ID.

```python
client = db.get_client_by_id(1)
```

### `add_client(name: str, phone: str, telegram_id: int, notes: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

```python
client_id = db.add_client(
    name="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    phone="+7 900 123-45-67",
    telegram_id=123456789,
    notes="VIP –∫–ª–∏–µ–Ω—Ç"
)
print(f"–°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç ID: {client_id}")
```

### `update_client(client_id: int, **kwargs) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞.

```python
success = db.update_client(
    client_id=1,
    phone="+7 900 999-99-99",
    notes="–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏"
)
```

### `get_all_clients(limit: int = 100) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100).

```python
clients = db.get_all_clients(limit=50)
for client in clients:
    print(client['name'])
```

---

## –£—Å–ª—É–≥–∏ (Services)

### `get_all_services(active_only: bool = True) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥.

```python
# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
services = db.get_all_services()

# –í—Å–µ —É—Å–ª—É–≥–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
all_services = db.get_all_services(active_only=False)
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'name': '–°—Ç—Ä–∏–∂–∫–∞',
        'price': Decimal('1500.00'),
        'duration_minutes': 60,
        'description': '–ú—É–∂—Å–∫–∞—è –∏–ª–∏ –∂–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞',
        'is_active': True,
        'created_at': datetime(2025, 1, 1, 10, 0, 0)
    },
    ...
]
```

### `get_service_by_id(service_id: int) -> Optional[dict]`

–ü–æ–ª—É—á–∞–µ—Ç —É—Å–ª—É–≥—É –ø–æ ID.

```python
service = db.get_service_by_id(1)
print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

### `add_service(name: str, price: float, duration_minutes: int = 60, description: str = None) -> int`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —É—Å–ª—É–≥—É.

```python
service_id = db.add_service(
    name="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ",
    price=3000.00,
    duration_minutes=120,
    description="–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å"
)
```

---

## –ó–∞–ø–∏—Å–∏ (Appointments)

### `add_appointment(client_id: int, service_id: int, appointment_datetime: datetime, comment: str = None) -> int`

–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.

```python
from datetime import datetime

appointment_id = db.add_appointment(
    client_id=1,
    service_id=1,
    appointment_datetime=datetime(2025, 12, 15, 14, 30),
    comment="–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É"
)
```

### `get_client_appointments(client_id: int, status: str = None) -> list[dict]`

–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞.

```python
# –í—Å–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id=1)

# –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
pending = db.get_client_appointments(client_id=1, status='pending')
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
[
    {
        'id': 1,
        'client_id': 1,
        'service_id': 1,
        'appointment_datetime': datetime(2025, 12, 15, 14, 30),
        'status': 'pending',
        'comment': '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω–Ω—É',
        'created_at': datetime(2025, 12, 1, 10, 0, 0),
        'service_name': '–°—Ç—Ä–∏–∂–∫–∞',  # JOIN —Å services
        'price': Decimal('1500.00')
    },
    ...
]
```

### `update_appointment_status(appointment_id: int, status: str) -> bool`

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏.

```python
# –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å
db.update_appointment_status(appointment_id=1, status='confirmed')

# –ó–∞–≤–µ—Ä—à–∏—Ç—å
db.update_appointment_status(appointment_id=1, status='completed')
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### `cancel_appointment(appointment_id: int) -> bool`

–û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è `update_appointment_status`).

```python
success = db.cancel_appointment(appointment_id=1)
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `get_stats() -> dict`

–ü–æ–ª—É—á–∞–µ—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã.

```python
stats = db.get_stats()
print(f"–ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
print(f"–£—Å–ª—É–≥: {stats['services_count']}")
print(f"–ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
print(f"–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º: {stats['appointments_by_status']}")
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'clients_count': 150,
    'services_count': 10,
    'appointments_count': 450,
    'appointments_by_status': {
        'pending': 25,
        'confirmed': 50,
        'completed': 350,
        'cancelled': 25
    }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º

```python
from database import db
from datetime import datetime, timedelta

# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client_id = db.add_client(
    name="–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
    phone="+7 900 555-55-55",
    telegram_id=987654321
)

# 2. –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
tomorrow = datetime.now() + timedelta(days=1)
appointment_time = tomorrow.replace(hour=14, minute=0, second=0)

appointment_id = db.add_appointment(
    client_id=client_id,
    service_id=services[0]['id'],
    appointment_datetime=appointment_time
)

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
appointments = db.get_client_appointments(client_id)
for app in appointments:
    print(f"–ó–∞–ø–∏—Å—å #{app['id']}: {app['service_name']} - {app['appointment_datetime']}")

# 5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
db.update_appointment_status(appointment_id, 'confirmed')

# 6. –ü–æ—Å–ª–µ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥–∏
db.update_appointment_status(appointment_id, 'completed')

# 7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = db.get_stats()
print(f"–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
```

### –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

```python
from datetime import datetime, timedelta

def get_available_slots(service_id: int, date: datetime) -> list:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –¥–∞—Ç—É."""
    # –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ database.py
    # –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
    
    all_slots = [
        datetime.combine(date, datetime.strptime(t, "%H:%M").time())
        for t in ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00"]
    ]
    
    # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã –∏–∑ –ë–î
    # busy_slots = db.get_busy_slots(service_id, date)
    # available = [s for s in all_slots if s not in busy_slots]
    
    return all_slots
```

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

–î–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:

### `get_connection()`

```python
with db.get_connection() as conn:
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM clients")
    results = cursor.fetchall()
```

### `get_cursor(dict_cursor: bool = True)`

```python
with db.get_cursor() as cursor:
    cursor.execute("SELECT * FROM services WHERE price > %s", (1000,))
    expensive_services = cursor.fetchall()
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î:

```python
try:
    client_id = db.add_client(
        name="Test",
        phone="+7 900 111-11-11",
        telegram_id=111111111
    )
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- `psycopg2.IntegrityError` ‚Äî –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏–∫–∞—Ç telegram_id)
- `psycopg2.OperationalError` ‚Äî –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `psycopg2.ProgrammingError` ‚Äî –æ—à–∏–±–∫–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞

---

## SQL-—Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü

### clients
```sql
CREATE TABLE clients (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    phone VARCHAR(50),
    telegram_id BIGINT UNIQUE,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### services
```sql
CREATE TABLE services (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    duration_minutes INTEGER DEFAULT 60,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### appointments
```sql
CREATE TABLE appointments (
    id SERIAL PRIMARY KEY,
    client_id INTEGER NOT NULL REFERENCES clients(id) ON DELETE CASCADE,
    service_id INTEGER NOT NULL REFERENCES services(id),
    appointment_datetime TIMESTAMP NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```


```

–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–æ–≤–µ—Ä—é, –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å –ª–∏ –µ—â–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≥–æ–¥–∞:

‚úÖ **–ì–æ—Ç–æ–≤–æ!** –í—Å–µ –¥–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å 2024 –Ω–∞ 2025.

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **AUTOSERVICE_SERVICES.md**
   - ‚úÖ "–ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025 –≥–æ–¥–∞"
   - ‚úÖ "–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2025"

2. **DATABASE_API.md**
   - ‚úÖ –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –¥–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ 2025 –≥–æ–¥
   - ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –≤ –∫–æ–¥–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç 2025 –≥–æ–¥

–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∞—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã! üéâ

---

**User**

–ó–∞–≥—Ä—É–∑–∏–ª —É—Å–ª—É–≥–∏ –≤ –ë–î. –ó–∞–≥—Ä—É–∂–µ–Ω–æ 51 —É—Å–ª—É–≥–∞, –∞ –≤ —Ç–≤–æ–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ 53. –ü—Ä–æ–≤–µ—Ä—å –ø–æ—á–µ–º—É —Ä–∞—Å—Ö–æ—ç–∂–¥–µ–Ω–∏–µ

---

**Cursor**

–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä—é —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª—É–≥ –≤ —Å–∫—Ä–∏–ø—Ç–µ:

–í—ã –ø—Ä–∞–≤—ã! –Ø –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª —É—Å–ª—É–≥–∏ –≤ –∫–æ–¥–µ. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:

–í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã! –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ —Å–ø–∏—Å–∫–µ **51 —É—Å–ª—É–≥–∞**, –∞ –Ω–µ 53. –Ø –æ—à–∏–±—Å—è –ø—Ä–∏ –ø–æ–¥—Å—á—ë—Ç–µ. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª—é —ç—Ç–æ –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö:

–ù–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç. –°–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å 53 –Ω–∞ 51:

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 51 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —É—Å–ª—É–≥–∏: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 53 —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–ë–æ—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ **53 —É—Å–ª—É–≥**:

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:

- üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è **–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π**
- üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å**
- üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª**
- üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**
- ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- üîß **–†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è**
- üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä**
- üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
- ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏**

**–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:** [AUTOSERVICE_SERVICES.md](AUTOSERVICE_SERVICES.md)

### –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥:

```bash
python add_autoservice_services.py
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥:

```python
from database import db

db.add_service(
    name="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",
    price=2500.00,
    duration_minutes=120,
    description="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
)
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 51 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —É—Å–ª—É–≥–∏: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 51 —É—Å–ª—É–≥–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–ë–æ—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ **53 —É—Å–ª—É–≥**:

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:

- üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è **–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π**
- üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å**
- üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª**
- üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**
- ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- üîß **–†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è**
- üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä**
- üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
- ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏**

**–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:** [AUTOSERVICE_SERVICES.md](AUTOSERVICE_SERVICES.md)

### –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥:

```bash
python add_autoservice_services.py
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥:

```python
from database import db

db.add_service(
    name="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",
    price=2500.00,
    duration_minutes=120,
    description="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
)
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 51 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —É—Å–ª—É–≥–∏: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 51 —É—Å–ª—É–≥–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–ë–æ—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ **53 —É—Å–ª—É–≥**:

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:

- üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è **–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π**
- üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å**
- üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª**
- üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**
- ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- üîß **–†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è**
- üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä**
- üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
- ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏**

**–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:** [AUTOSERVICE_SERVICES.md](AUTOSERVICE_SERVICES.md)

### –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥:

```bash
python add_autoservice_services.py
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥:

```python
from database import db

db.add_service(
    name="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",
    price=2500.00,
    duration_minutes=120,
    description="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
)
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó CRM Telegram Bot –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–µ. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ 51 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —É—Å–ª—É–≥–∏: –æ—Ç –¢–û –∏ —Ä–µ–º–æ–Ω—Ç–∞ –¥–æ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–∞ –∏ –∫—É–∑–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∫–µ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
- üöó **–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥** ‚Äî 51 —É—Å–ª—É–≥–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ —Å —Ü–µ–Ω–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- üìÖ **–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É** ‚Äî –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é
- üìã **–ú–æ–∏ –∑–∞–ø–∏—Å–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
- üë§ **–ü—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üóÑ **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Neon
- üîß **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥** ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—Å–ª—É–≥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CRM_Bot/
‚îú‚îÄ‚îÄ bot.py                         # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ database.py                    # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îú‚îÄ‚îÄ add_autoservice_services.py   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–∑ env.example.txt)
‚îú‚îÄ‚îÄ AUTOSERVICE_SERVICES.md        # –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ DATABASE_API.md                # API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

- **clients** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã (id, name, phone, telegram_id, notes, created_at)
- **services** ‚Äî —É—Å–ª—É–≥–∏ (id, name, price, duration_minutes, description, is_active)
- **appointments** ‚Äî –∑–∞–ø–∏—Å–∏ (id, client_id, service_id, appointment_datetime, status, comment)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=your_telegram_bot_token_here
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:** [@BotFather](https://t.me/BotFather)  
**–°–æ–∑–¥–∞—Ç—å –ë–î:** [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/book` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/services` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å–ª—É–≥
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

## üîß –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

–ë–æ—Ç –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏–∑ **51 —É—Å–ª—É–≥–∏**:

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:

- üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è **–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π**
- üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å**
- üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª**
- üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**
- ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
- üîß **–†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è**
- üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä**
- üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
- ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏**

**–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:** [AUTOSERVICE_SERVICES.md](AUTOSERVICE_SERVICES.md)

### –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥:

```bash
python add_autoservice_services.py
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —É—Å–ª—É–≥:

```python
from database import db

db.add_service(
    name="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏",
    price=2500.00,
    duration_minutes=120,
    description="–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏"
)
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí `/register` (–∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω)
3. **–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥** ‚Üí `/services`
4. **–ó–∞–ø–∏—Å—å** ‚Üí `/book` ‚Üí –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Üí –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞!
6. **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Üí `/my_appointments`

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:

- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–º
- üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö
- üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
- ‚≠ê –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
- üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–ø–∏—Å–∏

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π

- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `confirmed` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.12+**
- **pyTelegramBotAPI** ‚Äî Telegram Bot API
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Neon** ‚Äî –æ–±–ª–∞—á–Ω—ã–π —Ö–æ—Å—Ç–∏–Ω–≥ PostgreSQL
- **python-dotenv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤.

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ Telegram!


```

```markdown
# üöó –£—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –¥–ª—è CRM-–±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- [–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π](#–∑–∞–º–µ–Ω–∞-–º–∞—Å–µ–ª-–∏-–∂–∏–¥–∫–æ—Å—Ç–µ–π)
- [–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#—Ç–æ—Ä–º–æ–∑–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å](#—Ö–æ–¥–æ–≤–∞—è-—á–∞—Å—Ç—å)
- [–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª](#—Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª)
- [–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂](#—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)
- [–≠–ª–µ–∫—Ç—Ä–∏–∫–∞](#—ç–ª–µ–∫—Ç—Ä–∏–∫–∞)
- [–î–≤–∏–≥–∞—Ç–µ–ª—å](#–¥–≤–∏–≥–∞—Ç–µ–ª—å)
- [–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#–≤—ã—Ö–ª–æ–ø–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä](#–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä)
- [–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã](#–∫—É–∑–æ–≤–Ω—ã–µ-—Ä–∞–±–æ—Ç—ã)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—É—Å–ª—É–≥–∏)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –¢–û-2 (30 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 7,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤

### –¢–û-3 (60 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤

### –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 5 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

---

## üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π

### –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

### –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å

### –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤
- **–¶–µ–Ω–∞:** 2,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞

### –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏

### –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏

---

## üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å

---

## üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 1,600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 50 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 40 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å

### –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 400 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤

---

## ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞

### –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

---

## üîß –î–≤–∏–≥–∞—Ç–µ–ª—å

### –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 1,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú
- **–¶–µ–Ω–∞:** 6,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏

### –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 6 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏

### –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)

---

## üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä

### –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å

### –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 8 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)

### –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 5,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞

---

## ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤

### –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞
- **–¶–µ–Ω–∞:** 4,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞

### –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 51

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: 4 —É—Å–ª—É–≥–∏
- –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏: 5 —É—Å–ª—É–≥
- –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 4 —É—Å–ª—É–≥–∏
- –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å: 5 —É—Å–ª—É–≥
- –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª: 2 —É—Å–ª—É–≥–∏
- –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 6 —É—Å–ª—É–≥
- –≠–ª–µ–∫—Ç—Ä–∏–∫–∞: 5 —É—Å–ª—É–≥
- –î–≤–∏–≥–∞—Ç–µ–ª—å: 6 —É—Å–ª—É–≥
- –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 3 —É—Å–ª—É–≥–∏
- –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä: 3 —É—Å–ª—É–≥–∏
- –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: 4 —É—Å–ª—É–≥–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏: 4 —É—Å–ª—É–≥–∏

**–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.

---

## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ó–∞–ø—á–∞—Å—Ç–∏:** –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –ó–∞–ø—á–∞—Å—Ç–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–í—Ä–µ–º—è:** –£–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
3. **–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ù–∞ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π.
4. **–¶–µ–Ω—ã:** –ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025 –≥–æ–¥–∞.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª**
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67
- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã: –ü–Ω-–ü—Ç 9:00-20:00, –°–±-–í—Å 10:00-18:00
- –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è, 123

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2025*


```

```markdown
# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

- ‚úîÔ∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ (`venv/`)
- ‚úîÔ∏è –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úîÔ∏è –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
- ‚úîÔ∏è 51 —É—Å–ª—É–≥–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ñ–∞–π–ª `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ì–¥–µ –≤–∑—è—Ç—å:**
- **BOT_TOKEN** ‚Üí [@BotFather](https://t.me/BotFather) –≤ Telegram
- **DATABASE_URL** ‚Üí [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

---

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
.\venv\Scripts\python.exe add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 53 —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:**
- üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π
- üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å
- üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª
- üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6 —É—Å–ª—É–≥)
- ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (—Ñ–∏–ª—å—Ç—Ä—ã, –ì–†–ú –∏ —Ç.–¥.)
- üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä
- üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
.\venv\Scripts\python.exe bot.py
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ

üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: 0
   ‚Ä¢ –£—Å–ª—É–≥: 53
   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: 0

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ (–ø–æ –∏–º–µ–Ω–∏ –∏–∑ BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ `/register`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–ª—É–≥–∏ —á–µ—Ä–µ–∑ `/services`
5. –ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —É—Å–ª—É–≥—É —á–µ—Ä–µ–∑ `/book`

---

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/services` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —É—Å–ª—É–≥
- `/book` ‚Äî –∑–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- `DATABASE_API.md` ‚Äî API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `README.md` ‚Äî –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `SETUP.md` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É

```python
from database import db

db.add_service(
    name="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏",
    price=5000.00,
    duration_minutes=180,
    description="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏

```python
from database import db

services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `BOT_TOKEN` –∏ `DATABASE_URL`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ

### –ù–µ—Ç —É—Å–ª—É–≥ –≤ –±–æ—Ç–µ
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python add_autoservice_services.py`
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É (–≤–≤–µ–¥–∏—Ç–µ "yes")

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ —Ñ–∞–π–ª–µ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ Neon.tech
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –µ—Å—Ç—å `?sslmode=require`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `README.md` –∏ `SETUP.md`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞

---

**–ì–æ—Ç–æ–≤–æ! –í–∞—à –±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöó**


```

```markdown
# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

- ‚úîÔ∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ (`venv/`)
- ‚úîÔ∏è –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úîÔ∏è –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
- ‚úîÔ∏è 51 —É—Å–ª—É–≥–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ñ–∞–π–ª `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ì–¥–µ –≤–∑—è—Ç—å:**
- **BOT_TOKEN** ‚Üí [@BotFather](https://t.me/BotFather) –≤ Telegram
- **DATABASE_URL** ‚Üí [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

---

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
.\venv\Scripts\python.exe add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:**
- üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π
- üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å
- üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª
- üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6 —É—Å–ª—É–≥)
- ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (—Ñ–∏–ª—å—Ç—Ä—ã, –ì–†–ú –∏ —Ç.–¥.)
- üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä
- üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
.\venv\Scripts\python.exe bot.py
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ

üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: 0
   ‚Ä¢ –£—Å–ª—É–≥: 53
   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: 0

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ (–ø–æ –∏–º–µ–Ω–∏ –∏–∑ BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ `/register`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–ª—É–≥–∏ —á–µ—Ä–µ–∑ `/services`
5. –ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —É—Å–ª—É–≥—É —á–µ—Ä–µ–∑ `/book`

---

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/services` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —É—Å–ª—É–≥
- `/book` ‚Äî –∑–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- `DATABASE_API.md` ‚Äî API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `README.md` ‚Äî –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `SETUP.md` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É

```python
from database import db

db.add_service(
    name="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏",
    price=5000.00,
    duration_minutes=180,
    description="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏

```python
from database import db

services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `BOT_TOKEN` –∏ `DATABASE_URL`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ

### –ù–µ—Ç —É—Å–ª—É–≥ –≤ –±–æ—Ç–µ
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python add_autoservice_services.py`
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É (–≤–≤–µ–¥–∏—Ç–µ "yes")

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ —Ñ–∞–π–ª–µ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ Neon.tech
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –µ—Å—Ç—å `?sslmode=require`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `README.md` –∏ `SETUP.md`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞

---

**–ì–æ—Ç–æ–≤–æ! –í–∞—à –±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöó**


```

```markdown
# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

- ‚úîÔ∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ (`venv/`)
- ‚úîÔ∏è –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úîÔ∏è –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
- ‚úîÔ∏è 51 —É—Å–ª—É–≥–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ñ–∞–π–ª `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example.txt`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
DATABASE_URL=postgresql://user:password@host.neon.tech:5432/dbname?sslmode=require
```

**–ì–¥–µ –≤–∑—è—Ç—å:**
- **BOT_TOKEN** ‚Üí [@BotFather](https://t.me/BotFather) –≤ Telegram
- **DATABASE_URL** ‚Üí [neon.tech](https://neon.tech) (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

---

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å–ª—É–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
.\venv\Scripts\python.exe add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ 51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:**
- üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û-1, –¢–û-2, –¢–û-3)
- üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π
- üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å
- üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª
- üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6 —É—Å–ª—É–≥)
- ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (—Ñ–∏–ª—å—Ç—Ä—ã, –ì–†–ú –∏ —Ç.–¥.)
- üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä
- üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
.\venv\Scripts\python.exe bot.py
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ

üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: 0
   ‚Ä¢ –£—Å–ª—É–≥: 51
   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: 0

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ (–ø–æ –∏–º–µ–Ω–∏ –∏–∑ BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ `/register`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–ª—É–≥–∏ —á–µ—Ä–µ–∑ `/services`
5. –ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —É—Å–ª—É–≥—É —á–µ—Ä–µ–∑ `/book`

---

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- `/services` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —É—Å–ª—É–≥
- `/book` ‚Äî –∑–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
- `/my_appointments` ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏
- `/profile` ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AUTOSERVICE_SERVICES.md` ‚Äî –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- `DATABASE_API.md` ‚Äî API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `README.md` ‚Äî –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `SETUP.md` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É

```python
from database import db

db.add_service(
    name="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏",
    price=5000.00,
    duration_minutes=180,
    description="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —É—Å–ª—É–≥–∏

```python
from database import db

services = db.get_all_services()
for service in services:
    print(f"{service['name']}: {service['price']} —Ä—É–±.")
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `BOT_TOKEN` –∏ `DATABASE_URL`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ

### –ù–µ—Ç —É—Å–ª—É–≥ –≤ –±–æ—Ç–µ
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python add_autoservice_services.py`
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É (–≤–≤–µ–¥–∏—Ç–µ "yes")

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ —Ñ–∞–π–ª–µ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ Neon.tech
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –µ—Å—Ç—å `?sslmode=require`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `README.md` –∏ `SETUP.md`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞

---

**–ì–æ—Ç–æ–≤–æ! –í–∞—à –±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöó**


```

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ. –î–∞–≤–∞–π—Ç–µ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—é —Ç–æ—á–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –æ–±–Ω–æ–≤–ª—é –µ—ë –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```python
"""–ü–æ–¥—Å—á—ë—Ç —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"""
from add_autoservice_services import AUTOSERVICE_SERVICES

categories = {
    '–¢–û': 0,
    '–ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': 0,
    '–¢–æ—Ä–º–æ–∑–∞': 0,
    '–•–æ–¥–æ–≤–∞—è': 0,
    '–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': 0,
    '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': 0,
    '–≠–ª–µ–∫—Ç—Ä–∏–∫–∞': 0,
    '–î–≤–∏–≥–∞—Ç–µ–ª—å': 0,
    '–í—ã—Ö–ª–æ–ø': 0,
    '–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': 0,
    '–ö—É–∑–æ–≤': 0,
    '–î–æ–ø. —É—Å–ª—É–≥–∏': 0
}

for service in AUTOSERVICE_SERVICES:
    name = service['name']
    if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name:
        categories['–¢–û'] += 1
    elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç–∏' in name:
        categories['–ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'] += 1
    elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
        categories['–¢–æ—Ä–º–æ–∑–∞'] += 1
    elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
        categories['–•–æ–¥–æ–≤–∞—è'] += 1
    elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
        categories['–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'] += 1
    elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
        categories['–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'] += 1
    elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
        categories['–≠–ª–µ–∫—Ç—Ä–∏–∫–∞'] += 1
    elif any(word in name.lower() for word in ['–¥–≤–∏–≥–∞—Ç–µ–ª', '–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']):
        categories['–î–≤–∏–≥–∞—Ç–µ–ª—å'] += 1
    elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
        categories['–í—ã—Ö–ª–æ–ø'] += 1
    elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
        categories['–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'] += 1
    elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
        categories['–ö—É–∑–æ–≤'] += 1
    else:
        categories['–î–æ–ø. —É—Å–ª—É–≥–∏'] += 1

print("\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú:\n")
for cat, count in categories.items():
    if count > 0:
        print(f"   {cat}: {count} —É—Å–ª—É–≥(–∏)")

print(f"\n‚úÖ –ò–¢–û–ì–û: {sum(categories.values())} —É—Å–ª—É–≥")

```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —É –º–µ–Ω—è —Ç–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –î–∞–≤–∞–π—Ç–µ –æ–±–Ω–æ–≤–ª—é –µ—ë –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```markdown
# üöó –£—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª

–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –¥–ª—è CRM-–±–æ—Ç–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
- [–ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π](#–∑–∞–º–µ–Ω–∞-–º–∞—Å–µ–ª-–∏-–∂–∏–¥–∫–æ—Å—Ç–µ–π)
- [–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#—Ç–æ—Ä–º–æ–∑–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å](#—Ö–æ–¥–æ–≤–∞—è-—á–∞—Å—Ç—å)
- [–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª](#—Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª)
- [–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂](#—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)
- [–≠–ª–µ–∫—Ç—Ä–∏–∫–∞](#—ç–ª–µ–∫—Ç—Ä–∏–∫–∞)
- [–î–≤–∏–≥–∞—Ç–µ–ª—å](#–¥–≤–∏–≥–∞—Ç–µ–ª—å)
- [–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞](#–≤—ã—Ö–ª–æ–ø–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞)
- [–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä](#–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä)
- [–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã](#–∫—É–∑–æ–≤–Ω—ã–µ-—Ä–∞–±–æ—Ç—ã)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—É—Å–ª—É–≥–∏)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –¢–û-2 (30 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 7,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∏ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—Ä–º–æ–∑–æ–≤

### –¢–û-3 (60 —Ç—ã—Å. –∫–º)
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –¢–û: –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–≤–µ—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏, —Ç–æ—Ä–º–æ–∑–æ–≤

### –ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 5 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∫ –ø—Ä–æ–¥–∞–∂–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –º–æ–π–∫–∞, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

---

## üõ¢Ô∏è –ó–∞–º–µ–Ω–∞ –º–∞—Å–µ–ª –∏ –∂–∏–¥–∫–æ—Å—Ç–µ–π

### –ó–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª–µ —Å –º–∞—Å–ª—è–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º (–º–∞—Å–ª–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ê–ö–ü–ü)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Å–ª–∞ (–ú–ö–ü–ü)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä–æ–±–∫–µ –ø–µ—Ä–µ–¥–∞—á

### –ó–∞–º–µ–Ω–∞ –æ—Ö–ª–∞–∂–¥–∞—é—â–µ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–∞/—Ç–æ—Å–æ–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –∂–∏–¥–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–∫–∞—á–∫–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –∫–æ–ª–æ–¥–æ–∫
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–ª–æ–¥–æ–∫ –Ω–∞ –∑–∞–¥–Ω–µ–π –æ—Å–∏ (–∫–æ–ª–æ–¥–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (–∫–æ–º–ø–ª–µ–∫—Ç)
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏—Ö –∏–ª–∏ –∑–∞–¥–Ω–∏—Ö —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

### –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –∏–∑ —Ç–æ—Ä–º–æ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å

### –ó–∞–º–µ–Ω–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞ (–∑–∞–ø—á–∞—Å—Ç—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å—Ç–æ–µ–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤
- **–¶–µ–Ω–∞:** 2,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä—É–ª–µ–≤—ã—Ö –Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π —Å—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª–∞

### –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —à–∞—Ä–æ–≤–æ–π –æ–ø–æ—Ä—ã –ø–æ–¥–≤–µ—Å–∫–∏

### –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫–æ–≤ —Ä—ã—á–∞–≥–æ–≤ –ø–æ–¥–≤–µ—Å–∫–∏

---

## üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (1 –æ—Å—å)
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª—ë—Å –æ–¥–Ω–æ–π –æ—Å–∏

### –†–∞–∑–≤–∞–ª-—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 3D (2 –æ—Å–∏)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** 3D —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–ª—ë—Å

---

## üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 1,600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R13-R15

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 50 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R16-R17

### –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R18-R20 (4 –∫–æ–ª–µ—Å–∞)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏–Ω —Ä–∞–¥–∏—É—Å–∞ R18-R20

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–æ–ª—ë—Å (4 —à—Ç)
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 40 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–æ–ª—ë—Å

### –†–µ–º–æ–Ω—Ç –ø—Ä–æ–∫–æ–ª–æ–≤ (1 —à—Ç)
- **–¶–µ–Ω–∞:** 400 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–ª–∞ —à–∏–Ω—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —à–∏–Ω (—Å–µ–∑–æ–Ω)
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–∑–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —à–∏–Ω (4 —à—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤

---

## ‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞

### –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π –±–∞—Ç–∞—Ä–µ–∏ (–ê–ö–ë –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–∏–∫–∏
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –ó–∞–º–µ–Ω–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Å–≤–µ—á–µ–π –∑–∞–∂–∏–≥–∞–Ω–∏—è

### –ó–∞–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 3,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞

---

## üîß –î–≤–∏–≥–∞—Ç–µ–ª—å

### –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 1,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é —Å–∫–∞–Ω–µ—Ä–∞

### –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –ì–†–ú
- **–¶–µ–Ω–∞:** 6,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ä–µ–º–Ω—è –≥–∞–∑–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–æ–ª–∏–∫–∞–º–∏

### –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú
- **–¶–µ–Ω–∞:** 12,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 6 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ü–µ–ø–∏ –ì–†–ú —Å –Ω–∞—Ç—è–∂–∏—Ç–µ–ª—è–º–∏ –∏ —É—Å–ø–æ–∫–æ–∏—Ç–µ–ª—è–º–∏

### –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è

### –ó–∞–º–µ–Ω–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Ç–æ–ø–ª–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ —Å–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **–¶–µ–Ω–∞:** 600 —Ä—É–±.
- **–í—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–∞–ª–æ–Ω–∞ (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞)

---

## üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –≥–ª—É—à–∏—Ç–µ–ª—è –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –†–µ–º–æ–Ω—Ç –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–¶–µ–Ω–∞:** 1,800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–º–æ–Ω—Ç/–∑–∞–≤–∞—Ä–∫–∞ –≤—ã—Ö–ª–æ–ø–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä

### –ó–∞–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å

### –ß–∏—Å—Ç–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞
- **–¶–µ–Ω–∞:** 1,200 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1 —á–∞—Å
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### –ü–æ–∫—Ä–∞—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 8,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 8 —á–∞—Å–æ–≤
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫—Ä–∞—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫—É–∑–æ–≤–∞ (–¥–≤–µ—Ä—å, –∫—Ä—ã–ª–æ –∏ —Ç.–¥.)

### –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 5,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –†–∏—Ö—Ç–æ–≤–∫–∞ –∫—É–∑–æ–≤–∞
- **–¶–µ–Ω–∞:** 3,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 3 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∏—Ö—Ç–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### –ó–∞–º–µ–Ω–∞ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞
- **–¶–µ–Ω–∞:** 4,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–Ω—è—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–±–æ–≤–æ–≥–æ —Å—Ç–µ–∫–ª–∞

---

## ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–æ–π–∫–∞
- **–¶–µ–Ω–∞:** 800 —Ä—É–±.
- **–í—Ä–µ–º—è:** 45 –º–∏–Ω—É—Ç
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–æ–π–∫–∞ –∫—É–∑–æ–≤–∞, –¥–∏—Å–∫–æ–≤, –∫–æ–≤—Ä–∏–∫–æ–≤

### –•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞
- **–¶–µ–Ω–∞:** 4,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 4 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è —Ö–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

### –≠–≤–∞–∫—É–∞—Ç–æ—Ä (–ø–æ –≥–æ—Ä–æ–¥—É)
- **–¶–µ–Ω–∞:** 2,500 —Ä—É–±.
- **–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Å–ª—É–≥–∞ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥–∞

### –í—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–¶–µ–Ω–∞:** 2,000 —Ä—É–±.
- **–í—Ä–µ–º—è:** 2 —á–∞—Å–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ —É—Å–ª—É–≥:** 51

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: 4 —É—Å–ª—É–≥–∏
- –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏: 5 —É—Å–ª—É–≥
- –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 4 —É—Å–ª—É–≥–∏
- –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å: 5 —É—Å–ª—É–≥
- –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª: 2 —É—Å–ª—É–≥–∏
- –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 6 —É—Å–ª—É–≥
- –≠–ª–µ–∫—Ç—Ä–∏–∫–∞: 5 —É—Å–ª—É–≥
- –î–≤–∏–≥–∞—Ç–µ–ª—å: 6 —É—Å–ª—É–≥
- –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: 3 —É—Å–ª—É–≥–∏
- –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä: 3 —É—Å–ª—É–≥–∏
- –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: 4 —É—Å–ª—É–≥–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏: 4 —É—Å–ª—É–≥–∏

<i>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Å—É–º–º–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º = 51 —É—Å–ª—É–≥–∞</i>

**–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –æ—Ç 400 —Ä—É–±. –¥–æ 12,000 —Ä—É–±.

---

## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —É—Å–ª—É–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python add_autoservice_services.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ó–∞–ø—á–∞—Å—Ç–∏:** –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –ó–∞–ø—á–∞—Å—Ç–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–í—Ä–µ–º—è:** –£–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç.
3. **–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ù–∞ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—è 30 –¥–Ω–µ–π.
4. **–¶–µ–Ω—ã:** –ê–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2025 –≥–æ–¥–∞.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª**
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67
- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã: –ü–Ω-–ü—Ç 9:00-20:00, –°–±-–í—Å 10:00-18:00
- –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è, 123

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 3 –¥–µ–∫–∞–±—Ä—è 2025*


```

–û—Ç–ª–∏—á–Ω–æ! –î–∞–≤–∞–π—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! ‚úÖ **–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!** 

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª—É–≥: ~~53~~ ‚Üí **51**

**–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**

1. **README.md** ‚úÖ
   - "51 –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —É—Å–ª—É–≥–∏"
   - "51 —É—Å–ª—É–≥–∞ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞"
   - "51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
   - "51 —É—Å–ª—É–≥–∏"

2. **AUTOSERVICE_SERVICES.md** ‚úÖ
   - "–í—Å–µ–≥–æ —É—Å–ª—É–≥: 51"
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ —Ç–æ—á–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ

3. **QUICK_START.md** ‚úÖ
   - "51 —É—Å–ª—É–≥–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ"
   - "51 —É—Å–ª—É–≥—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
   - "–£—Å–ª—É–≥: 51"

### üìã –¢–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|-----------|------------|
| –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ | 4 |
| –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏ | 5 |
| –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ | 4 |
| –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å | 5 |
| –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª | 2 |
| –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ | 6 |
| –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ | 5 |
| –î–≤–∏–≥–∞—Ç–µ–ª—å | 6 |
| –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ | 3 |
| –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä | 3 |
| –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã | 4 |
| –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ | 4 |
| **–ò–¢–û–ì–û** | **51** |

–¢–µ–ø–µ—Ä—å –≤—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª—É–≥! üéâ

---

**User**

–æ—à–∏–±–∫–∞ –≤ –±–æ—Ç–µ

---

**Cursor**

–í–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É! –û—à–∏–±–∫–∞ "message is too long" –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º —É—Å–ª—É–≥ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç Telegram –≤ 4096 —Å–∏–º–≤–æ–ª–æ–≤. –° 51 —É—Å–ª—É–≥–æ–π —ç—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º –∫–æ–º–∞–Ω–¥—É `/services`, —á—Ç–æ–±—ã –æ–Ω–∞ —Ä–∞–∑–±–∏–≤–∞–ª–∞ —Å–ø–∏—Å–æ–∫ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π:

–ù–∞—à–µ–ª –ø—Ä–æ–±–ª–µ–º—É! –ö–æ–º–∞–Ω–¥–∞ `/services` –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ 51 —É—Å–ª—É–≥—É –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏, —á—Ç–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç Telegram –≤ 4096 —Å–∏–º–≤–æ–ª–æ–≤. –ò—Å–ø—Ä–∞–≤–ª—é, —Ä–∞–∑–±–∏–≤ —Å–ø–∏—Å–æ–∫ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ (—Ä–∞–∑–±–∏—Ç–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π)."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        header = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n\n"
            "–°–ø–∏—Å–æ–∫ —Ä–∞–∑–±–∏—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π..."
        )
        bot.reply_to(message, header, parse_mode='HTML')
        
        # –†–∞–∑–±–∏–≤–∞–µ–º —É—Å–ª—É–≥–∏ –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ 10 —à—Ç—É–∫
        services_per_message = 10
        total_messages = (len(services) + services_per_message - 1) // services_per_message
        
        for msg_num in range(total_messages):
            start_idx = msg_num * services_per_message
            end_idx = min(start_idx + services_per_message, len(services))
            services_batch = services[start_idx:end_idx]
            
            text = f"<b>üìã –ß–∞—Å—Ç—å {msg_num + 1} –∏–∑ {total_messages}</b>\n\n"
            
            for service in services_batch:
                text += (
                    f"üîπ <b>{service['name']}</b>\n"
                    f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
                )
                if service['description']:
                    # –£–∫–æ—Ä–∞—á–∏–≤–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
                    desc = service['description']
                    if len(desc) > 80:
                        desc = desc[:77] + "..."
                    text += f"   üìù {desc}\n"
                text += "\n"
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–ø–∏—Å–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            if msg_num == total_messages - 1:
                text += "\nüìù <b>–î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book</b>"
            
            bot.send_message(message.chat.id, text, parse_mode='HTML')
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### –ü—Ä–æ–±–ª–µ–º–∞:
–ö–æ–º–∞–Ω–¥–∞ `/services` –ø—ã—Ç–∞–ª–∞—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ 51 —É—Å–ª—É–≥—É –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏, —á—Ç–æ –ø—Ä–µ–≤—ã—à–∞–ª–æ –ª–∏–º–∏—Ç Telegram –≤ **4096 —Å–∏–º–≤–æ–ª–æ–≤**.

### –†–µ—à–µ–Ω–∏–µ:
–ü–µ—Ä–µ–ø–∏—Å–∞–ª –∫–æ–º–∞–Ω–¥—É `/services`, —á—Ç–æ–±—ã –æ–Ω–∞:

1. **–†–∞–∑–±–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞ —á–∞—Å—Ç–∏** ‚Äî –ø–æ 10 —É—Å–ª—É–≥ –≤ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
2. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫** —Å –æ–±—â–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—Å–ª—É–≥
3. **–ù—É–º–µ—Ä—É–µ—Ç —á–∞—Å—Ç–∏** ‚Äî "–ß–∞—Å—Ç—å 1 –∏–∑ 6", "–ß–∞—Å—Ç—å 2 –∏–∑ 6" –∏ —Ç.–¥.
4. **–°–æ–∫—Ä–∞—â–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è** ‚Äî –¥–æ 80 —Å–∏–º–≤–æ–ª–æ–≤ (–µ—Å–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω–µ–µ)
5. **–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** ‚Äî —Ü–µ–Ω–∞ –∏ –≤—Ä–µ–º—è –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

### –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

```
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê
üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: 51

üìã –ß–∞—Å—Ç—å 1 –∏–∑ 6
üîπ –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
   üí∞ 3500 —Ä—É–±. | ‚è± 120 –º–∏–Ω.
   üìù –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞...

... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

---

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥–∞ `/services` –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç 6 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ! üéâ

```plaintext
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê
üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: 51

üìã –ß–∞—Å—Ç—å 1 –∏–∑ 6
üîπ –¢–û-1 (–¥–æ 15 —Ç—ã—Å. –∫–º)
   üí∞ 3500 —Ä—É–±. | ‚è± 120 –º–∏–Ω.
   üìù –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞, –º–∞—Å–ª—è–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞...

... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

```shellscript
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

---

**User**

–¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫: —Å–Ω–∞—á–∞–ª–∞ –≤—ã–≤–æ–¥–∏ —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —É—Å–ª—É–≥, –∞ –ø–æ—Ç–æ–º –ø—É—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ç–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–π —É—Å–ª—É–≥–∏ –∏–∑ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ï—Å–ª–∏ –∏—Ö –±–æ–ª—å—à–µ 10 - –ø—É—Å—Ç—å –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ –≤—ã–≤–æ–¥ –¥–∞–ª–µ–µ

---

**Cursor**

–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –°–¥–µ–ª–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏. –≠—Ç–æ –±—É–¥–µ—Ç –Ω–∞–º–Ω–æ–≥–æ —É–¥–æ–±–Ω–µ–µ!

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –°–æ–∑–¥–∞—ë–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"service_{service['id']}"
            )
        )
    
    text = (
        "üìù <b>–ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É</b>\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("service_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–ª –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É—Å–ª—É–≥ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏!**

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### 1Ô∏è‚É£ **–ö–æ–º–∞–Ω–¥–∞ `/services` —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**

–í–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —É—Å–ª—É–≥, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç:

```
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê
üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: 51
üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: 12

–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:

[üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (4)]  [üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏ (5)]
[üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (4)]  [üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å (5)]
[üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª (2)]        [üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6)]
[‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ (5)]           [üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (6)]
[üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (3)]  [‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä (3)]
[üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (4)]    [‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (6)]
```

### 2Ô∏è‚É£ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–Ω–æ–ø–∫–æ–π**

–ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —É—Å–ª—É–≥–∏ –∏–∑ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### 3Ô∏è‚É£ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π**

–ï—Å–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–æ–ª—å—à–µ 10 —É—Å–ª—É–≥, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:
- **‚óÄÔ∏è –ù–∞–∑–∞–¥** ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–µ 10 —É—Å–ª—É–≥
- **üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏** ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–î–∞–ª–µ–µ ‚ñ∂Ô∏è** ‚Äî —Å–ª–µ–¥—É—é—â–∏–µ 10 —É—Å–ª—É–≥

### 4Ô∏è‚É£ **–£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è**

–í—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–Ω–æ–ø–∫–æ–π **"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏"**

---

## üìã –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:

1. üîß **–¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** (4 —É—Å–ª—É–≥–∏)
2. üõ¢Ô∏è **–ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏** (5 —É—Å–ª—É–≥)
3. üõë **–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** (4 —É—Å–ª—É–≥–∏)
4. üî© **–•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å** (5 —É—Å–ª—É–≥)
5. üìê **–°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª** (2 —É—Å–ª—É–≥–∏)
6. üöó **–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂** (6 —É—Å–ª—É–≥)
7. ‚ö° **–≠–ª–µ–∫—Ç—Ä–∏–∫–∞** (5 —É—Å–ª—É–≥)
8. üîß **–î–≤–∏–≥–∞—Ç–µ–ª—å** (6 —É—Å–ª—É–≥)
9. üí® **–í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** (3 —É—Å–ª—É–≥–∏)
10. ‚ùÑÔ∏è **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä** (3 —É—Å–ª—É–≥–∏)
11. üé® **–ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã** (4 —É—Å–ª—É–≥–∏)
12. ‚ûï **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ** (6 —É—Å–ª—É–≥)

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:**
1. `/services` ‚Äî —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî —É–≤–∏–¥–∏—Ç–µ —É—Å–ª—É–≥–∏
3. –ï—Å–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–æ–ª—å—à–µ 10 —É—Å–ª—É–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂") ‚Äî –±—É–¥–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—è
4. –ö–Ω–æ–ø–∫–∞ "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏" –≤–µ—Ä–Ω—ë—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

–¢–µ–ø–µ—Ä—å –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —É—Å–ª—É–≥–∞–º —Å—Ç–∞–ª–∞ –Ω–∞–º–Ω–æ–≥–æ —É–¥–æ–±–Ω–µ–µ! üéâ

```plaintext
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê
üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: 51
üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: 12

–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:

[üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (4)]  [üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏ (5)]
[üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (4)]  [üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å (5)]
[üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª (2)]        [üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (6)]
[‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞ (5)]           [üîß –î–≤–∏–≥–∞—Ç–µ–ª—å (6)]
[üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (3)]  [‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä (3)]
[üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (4)]    [‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (6)]
```

```shellscript
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

---

**User**

–û—Ç–ª–∏—á–Ω–æ. –î–∞–≤–∞–π –∏ –∑–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É —Å–¥–µ–ª–∞–µ–º –≤ —Ç–æ–π –∂–µ –ª–æ–≥–∏–∫–µ: –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–∞–∫–æ–π-–ª–∏–±–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - –ø—Ä–µ–¥–ª–æ–∂–∏ –µ–º—É –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∏–∑ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é - —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥–ª–æ–∂–∏ –µ–º—É –≤—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏, –∞ –ø–æ—Ç–æ–º –ø–æ–∫–∞–∂–∏ —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –¢–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –Ω–µ –∑–∞–ø—É—Ç–∞–µ—Ç—Å—è –≤ –±–æ–ª—å—à–æ–º —Å–ø–∏—Å–∫–µ —É—Å–ª—É–≥ –¢–µ–º –±–æ–ª–µ–µ, —á—Ç–æ —É—Å–ª—É–≥–∏ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º

---

**Cursor**

–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –°–¥–µ–ª–∞–µ–º –∑–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –≠—Ç–æ —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞!

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–µ–ª–∞—é –∫–æ–º–∞–Ω–¥—É `/book` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        "üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—é, –Ω–µ –Ω—É–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —á—Ç–æ-—Ç–æ –µ—â–µ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏:

–î–∞–≤–∞–π—Ç–µ —É–ª—É—á—à–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∞–≥–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–ø–∏—Å–∏:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    text = (
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        "üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        service_name = data.get('service_name', '–£—Å–ª—É–≥–∞')
        service_price = data.get('service_price', 0)
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service_name}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service_price} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–î–æ–±–∞–≤–ª—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º":

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        service_name = data.get('service_name', '–£—Å–ª—É–≥–∞')
        service_price = data.get('service_price', 0)
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service_name}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service_price} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_dates")
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        bot.answer_callback_query(call.id)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
            service_id = data.get('service_id')
            if not service_id:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞")
                return
            
            service = db.get_service_by_id(service_id)
            if not service:
                bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"date_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        date_str = data['appointment_date']
        date_display = datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üîπ –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –¶–µ–Ω–∞: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b>\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ\n\n"
                "üìã /my_appointments ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∏"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:\n<code>{e}</code>",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥–µ–ª–∞–ª —Å–∏—Å—Ç–µ–º—É –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥–∏!**

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### **–†–∞–Ω—å—à–µ:**
```
/book ‚Üí —Å–ø–∏—Å–æ–∫ –∏–∑ 51 —É—Å–ª—É–≥–∏ ‚Üí –≤—ã–±–æ—Ä ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
      (–Ω–µ—É–¥–æ–±–Ω–æ, –ª–µ–≥–∫–æ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è)
```

### **–¢–µ–ø–µ—Ä—å:**
```
/book ‚Üí –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí —É—Å–ª—É–≥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
      (—É–¥–æ–±–Ω–æ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ!)
```

---

## üìù –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏:

### **–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**
–ü–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/book` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:
```
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏

[üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (4)]  [üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏ (5)]
[üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (4)]  [üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å (5)]
...
```

### **–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏**
–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
```
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

–ö–∞—Ç–µ–≥–æ—Ä–∏—è: üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂
–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É (6 –¥–æ—Å—Ç—É–ø–Ω–æ):

[–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞) - 1600 —Ä—É–±.]
[–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞) - 2000 —Ä—É–±.]
...
[üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏]
```

### **–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–æ—Ä –¥–∞—Ç—ã**
```
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.

–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:

[–ü–Ω, 03.12.2025]  [–í—Ç, 04.12.2025]
...
```

### **–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏**
```
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 03.12.2025

–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:

[09:00]  [10:00]  [11:00]
...
[üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º]
```

### **‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**
```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ  –ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîπ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 03.12.2025
üïê –í—Ä–µ–º—è: 10:00

üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: #1

–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ
```

---

## üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

1. ‚úÖ **–ö–Ω–æ–ø–∫–∞ "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"** ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
2. ‚úÖ **–ö–Ω–æ–ø–∫–∞ "üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º"** ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã
3. ‚úÖ **–ù—É–º–µ—Ä–∞—Ü–∏—è —à–∞–≥–æ–≤** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
4. ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ** ‚Äî –≤—ã–±—Ä–∞–Ω–Ω–∞—è —É—Å–ª—É–≥–∞ –∏ —Ü–µ–Ω–∞ –≤–∏–¥–Ω—ã –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:**
1. `/book` ‚Äî —É–≤–∏–¥–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî —É–≤–∏–¥–∏—Ç–µ —É—Å–ª—É–≥–∏
3. –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ‚Üí –¥–∞—Ç—É ‚Üí –≤—Ä–µ–º—è
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ —Å—Ç–∞–ª–∞ **–Ω–∞–º–Ω–æ–≥–æ —É–¥–æ–±–Ω–µ–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π** ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —É—Å–ª—É–≥! üéâ

```plaintext
/book ‚Üí —Å–ø–∏—Å–æ–∫ –∏–∑ 51 —É—Å–ª—É–≥–∏ ‚Üí –≤—ã–±–æ—Ä ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
      (–Ω–µ—É–¥–æ–±–Ω–æ, –ª–µ–≥–∫–æ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è)
```

```plaintext
/book ‚Üí –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí —É—Å–ª—É–≥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è
      (—É–¥–æ–±–Ω–æ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ!)
```

```plaintext
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏

[üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (4)]  [üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏ (5)]
[üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (4)]  [üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å (5)]
...
```

```plaintext
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

–ö–∞—Ç–µ–≥–æ—Ä–∏—è: üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂
–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É (6 –¥–æ—Å—Ç—É–ø–Ω–æ):

[–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R13-R15 (4 –∫–æ–ª–µ—Å–∞) - 1600 —Ä—É–±.]
[–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞) - 2000 —Ä—É–±.]
...
[üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏]
```

```plaintext
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.

–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:

[–ü–Ω, 03.12.2025]  [–í—Ç, 04.12.2025]
...
```

```plaintext
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 03.12.2025

–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:

[09:00]  [10:00]  [11:00]
...
[üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º]
```

```plaintext
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ  –ó–ê–ü–ò–°–¨ –°–û–ó–î–ê–ù–ê!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîπ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 03.12.2025
üïê –í—Ä–µ–º—è: 10:00

üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: #1

–ú—ã –∂–¥—ë–º –≤–∞—Å! üéâ
```

```shellscript
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
.\venv\Scripts\python.exe bot.py
```

---

**User**

–ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –Ω–∞ —É–ª—É–≥—É, –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å–∞–º–æ–π —É—Å–ª—É–≥–∏ –≤ —à–∞–ø–∫–µ –∑–∞–ø–∏—Å–∏ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –≤—ã–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ "–£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" (–≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ).

–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –ø–æ –ª–æ–≥–∏–∫–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–∏–ø–∞ "–í—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ "—É—Å–ª—É–≥–∞" –≤ "–¥–µ–Ω—å, –≤—Ä–µ–º—è" –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –∑–∞–ø–∏—Å—å. –î–æ—Ä–∞–±–æ—Ç–∞–π

---

**Cursor**

–ü–æ–Ω—è–ª –ø—Ä–æ–±–ª–µ–º—ã! –°–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é:
1. –î–æ–±–∞–≤–ª—é –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –≤ —à–∞–ø–∫—É –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
2. –î–æ—Ä–∞–±–æ—Ç–∞—é —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏

–í–∏–∂—É, —á—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–¥–µ. –î–∞–≤–∞–π—Ç–µ —É–ª—É—á—à—É –µ–≥–æ –∏ –¥–æ–±–∞–≤–ª—é –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = f"<b>{category_name}</b>\n\n"
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        service_name = data.get('service_name', '–£—Å–ª—É–≥–∞')
        service_price = data.get('service_price', 0)
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service_name}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service_price} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_dates")
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        bot.answer_callback_query(call.id)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
            service_id = data.get('service_id')
            if not service_id:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞")
                return
            
            service = db.get_service_by_id(service_id)
            if not service:
                bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"date_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(data['service_id'])
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_str = data['appointment_date']
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            text = (
                "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
                "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
                "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
                f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
                f"üîß –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
                "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
                "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
                "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
            thanks_message = (
                "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
                "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
                "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
                "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
            )
            bot.send_message(
                call.message.chat.id,
                thanks_message,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
                f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
                f"<code>{e}</code>\n\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
                f"üìû +7 (900) 123-45-67",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—é, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏:

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º. –ù–æ —Å–Ω–∞—á–∞–ª–∞ —É–ª—É—á—à—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É—Å–ª—É–≥, —á—Ç–æ–±—ã —Ç–∞–º —Ç–∞–∫–∂–µ –±—ã–ª–∞ –≤–∏–¥–Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = (
        "üöó <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n\n"
        f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: <b>{len(services)}</b>\n\n"
    )
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['service_id'] = service_id
        data['service_name'] = service['name']
        data['service_price'] = float(service['price'])
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"date_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        service_name = data.get('service_name', '–£—Å–ª—É–≥–∞')
        service_price = data.get('service_price', 0)
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service_name}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service_price} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_dates")
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        bot.answer_callback_query(call.id)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
            service_id = data.get('service_id')
            if not service_id:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞")
                return
            
            service = db.get_service_by_id(service_id)
            if not service:
                bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"date_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(data['service_id'])
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_str = data['appointment_date']
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            text = (
                "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
                "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
                "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
                f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
                f"üîß –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
                "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
                "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
                "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
            thanks_message = (
                "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
                "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
                "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
                "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
            )
            bot.send_message(
                call.message.chat.id,
                thanks_message,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
                f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
                f"<code>{e}</code>\n\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
                f"üìû +7 (900) 123-45-67",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ **–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —É–ª—É—á—à–µ–Ω–æ!**

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### 1Ô∏è‚É£ **–£–ª—É—á—à–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —É—Å–ª—É–≥–∏**
–ù–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö –∑–∞–ø–∏—Å–∏ —Ç–µ–ø–µ—Ä—å —á–µ—Ç–∫–æ –≤–∏–¥–Ω–æ:
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
- üí∞ –¶–µ–Ω–∞
- ‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–æ–±–∞–≤–ª–µ–Ω–æ!)

### 2Ô∏è‚É£ **–ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏**

–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç —É–≤–∏–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  ‚úÖ  –ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üë§ –ö–ª–∏–µ–Ω—Ç: –Æ—Ä–∏–π –ï–º–µ–ª—å—è–Ω–æ–≤
üì± –¢–µ–ª–µ—Ñ–æ–Ω: +7 900 123-45-67

üîß –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: 2000 —Ä—É–±.
‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 50 –º–∏–Ω.

üìÖ –î–∞—Ç–∞: 05.12.2025 (—á–µ—Ç–≤–µ—Ä–≥)
üïê –í—Ä–µ–º—è: 10:00

üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: #1

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üíº –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª
–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó

–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.

üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏
üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67
```

### 3Ô∏è‚É£ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é**

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
üôè –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!

–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!

üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞.
```

### 4Ô∏è‚É£ **–£–ª—É—á—à–µ–Ω–∞ —à–∞–ø–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ —É—Å–ª—É–≥**

–ü—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
```
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê

üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂
üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: 6
```

### 5Ô∏è‚É£ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≤—Ä–µ–º—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å..."
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ctrl+C)
.\venv\Scripts\python.exe bot.py
```

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:**
1. `/book` ‚Üí –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
2. –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí —É–≤–∏–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ —à–∞–ø–∫–µ
3. –í—ã–±–æ—Ä –¥–∞—Ç—ã ‚Üí –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è
4. –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ ‚Üí **–∫—Ä–∞—Å–∏–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ + –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å!**

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–µ–Ω! üéâ

```plaintext
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  ‚úÖ  –ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üë§ –ö–ª–∏–µ–Ω—Ç: –Æ—Ä–∏–π –ï–º–µ–ª—å—è–Ω–æ–≤
üì± –¢–µ–ª–µ—Ñ–æ–Ω: +7 900 123-45-67

üîß –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: 2000 —Ä—É–±.
‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 50 –º–∏–Ω.

üìÖ –î–∞—Ç–∞: 05.12.2025 (—á–µ—Ç–≤–µ—Ä–≥)
üïê –í—Ä–µ–º—è: 10:00

üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: #1

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üíº –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª
–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó

–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.

üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏
üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67
```

```plaintext
üôè –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!

–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!

üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞.
```

```plaintext
üöó –£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê

üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂
üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: 6
```

```shellscript
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ctrl+C)
.\venv\Scripts\python.exe bot.py
```

---

**User**

1.–∫–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–µ—à—å –≤—Ä–µ–º—è —É—Å–ª—É–≥–∏ - –≤ —à–∞–ø–∫–µ –Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —É—Å–ª—É–≥–∏

2. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—à–∏–±–∫–∏ @PowerShell Extension (128-139) 

---

**Cursor**

–í–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É! –û—à–∏–±–∫–∞ `KeyError: 'service_id'` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É callback-–∑–∞–ø—Ä–æ—Å–∞–º–∏. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ `bot.retrieve_data` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ states, –∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º callback-—Ö–µ–Ω–¥–ª–µ—Ä—ã –±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

–ï—Å—Ç—å –¥–≤–∞ —Ä–µ—à–µ–Ω–∏—è:
1. –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `callback_data`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FSM (–º–∞—à–∏–Ω—É —Å–æ—Å—Ç–æ—è–Ω–∏–π)

–î–∞–≤–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥ - –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ callback_data:

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = (
        "üöó <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n\n"
        f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: <b>{len(services)}</b>\n\n"
    )
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("date_"))
def handle_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã."""
    date_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_date'] = date_str
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"time_{time}"
            )
        )
    
    keyboard.add(types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data="back_to_dates"))
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        service_name = data.get('service_name', '–£—Å–ª—É–≥–∞')
        service_price = data.get('service_price', 0)
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service_name}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service_price} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_dates")
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        bot.answer_callback_query(call.id)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
            service_id = data.get('service_id')
            if not service_id:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞")
                return
            
            service = db.get_service_by_id(service_id)
            if not service:
                bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"date_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(data['service_id'])
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_str = data['appointment_date']
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            text = (
                "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
                "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
                "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
                f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
                f"üîß –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
                "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
                "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
                "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
            thanks_message = (
                "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
                "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
                "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
                "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
            )
            bot.send_message(
                call.message.chat.id,
                thanks_message,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
                f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
                f"<code>{e}</code>\n\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
                f"üìû +7 (900) 123-45-67",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = (
        "üöó <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n\n"
        f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: <b>{len(services)}</b>\n\n"
    )
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("bdate_"))
def handle_booking_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –ü–∞—Ä—Å–∏–º callback_data: bdate_{service_id}_{date}
    parts = call.data.split("_")
    service_id = int(parts[1])
    date_str = parts[2]
    
    bot.answer_callback_query(call.id)
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    service = db.get_service_by_id(service_id)
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –∏ –¥–∞—Ç—É –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"btime_{service_id}_{date_str}_{time}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" —Å service_id
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º",
            callback_data=f"backserv_{service_id}"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_dates")
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        bot.answer_callback_query(call.id)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
            service_id = data.get('service_id')
            if not service_id:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞")
                return
            
            service = db.get_service_by_id(service_id)
            if not service:
                bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"date_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(data['service_id'])
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_str = data['appointment_date']
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            text = (
                "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
                "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
                "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
                f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
                f"üîß –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
                "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
                "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
                "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
            thanks_message = (
                "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
                "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
                "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
                "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
            )
            bot.send_message(
                call.message.chat.id,
                thanks_message,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
                f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
                f"<code>{e}</code>\n\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
                f"üìû +7 (900) 123-45-67",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = (
        "üöó <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n\n"
        f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: <b>{len(services)}</b>\n\n"
    )
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("bdate_"))
def handle_booking_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –ü–∞—Ä—Å–∏–º callback_data: bdate_{service_id}_{date}
    parts = call.data.split("_")
    service_id = int(parts[1])
    date_str = parts[2]
    
    bot.answer_callback_query(call.id)
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    service = db.get_service_by_id(service_id)
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –∏ –¥–∞—Ç—É –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"btime_{service_id}_{date_str}_{time}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" —Å service_id
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º",
            callback_data=f"backserv_{service_id}"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("backserv_"))
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º service_id –∏–∑ callback_data
        service_id = int(call.data.split("_")[1])
        
        bot.answer_callback_query(call.id)
        
        service = db.get_service_by_id(service_id)
        if not service:
            bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("time_"))
def handle_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    time_str = call.data.split("_")[1]
    
    bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è
    with bot.retrieve_data(call.from_user.id, call.message.chat.id) as data:
        data['appointment_time'] = time_str
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(data['service_id'])
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_str = data['appointment_date']
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        try:
            appointment_id = db.add_appointment(
                client_id=client['id'],
                service_id=data['service_id'],
                appointment_datetime=appointment_datetime
            )
            
            # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            text = (
                "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
                "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
                "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
                f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
                f"üîß –£—Å–ª—É–≥–∞: <b>{data['service_name']}</b>\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{data['service_price']} —Ä—É–±.</b>\n"
                f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
                f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
                f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
                f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
                "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
                "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
                "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
                "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
            )
            
            bot.edit_message_text(
                text,
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
            thanks_message = (
                "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
                "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
                "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
                "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
            )
            bot.send_message(
                call.message.chat.id,
                thanks_message,
                parse_mode='HTML'
            )
            
        except Exception as e:
            bot.edit_message_text(
                f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
                f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
                f"<code>{e}</code>\n\n"
                f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
                f"üìû +7 (900) 123-45-67",
                call.message.chat.id,
                call.message.message_id,
                parse_mode='HTML'
            )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

```python
"""
CRM Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —É—Å–ª—É–≥–∏.
"""

from datetime import datetime, timedelta
import re

import telebot
from telebot import types, custom_filters
from telebot.handler_backends import State, StatesGroup
from telebot.storage import StateMemoryStorage

from config import BOT_TOKEN
from database import db


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
if not BOT_TOKEN:
    raise ValueError("–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN. –£–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª–µ .env")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –±–æ—Ç–∞
state_storage = StateMemoryStorage()
bot = telebot.TeleBot(BOT_TOKEN, state_storage=state_storage)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã FSM!)
bot.add_custom_filter(custom_filters.StateFilter(bot))


# =============================================================================
# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
# =============================================================================

class ClientRegistration(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    waiting_for_name = State()
    waiting_for_phone = State()


class AppointmentBooking(StatesGroup):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ —É—Å–ª—É–≥—É."""
    selecting_service = State()
    selecting_date = State()
    selecting_time = State()
    confirming = State()


# =============================================================================
# –ö–æ–º–∞–Ω–¥—ã
# =============================================================================

@bot.message_handler(commands=['start'])
def cmd_start(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç
    client = db.get_client_by_telegram_id(message.from_user.id)
    
    if client:
        text = (
            f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{client['name']}</b>!\n\n"
            "üöó <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ!\n\n"
            "üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
            "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
            "üìã /my_appointments ‚Äî –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìä /services ‚Äî —É—Å–ª—É–≥–∏ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
            "üë§ /profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å\n"
            "‚ùì /help ‚Äî —Å–ø—Ä–∞–≤–∫–∞"
        )
    else:
        text = (
            f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
            "üöó –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>!\n\n"
            "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞:\n"
            "üîπ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n"
            "üîπ –†–µ–º–æ–Ω—Ç –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É\n"
            "üîπ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂\n"
            "üîπ –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
            "üîπ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
            "üìù –ù–∞–∂–º–∏—Ç–µ /register –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['help'])
def cmd_help(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "/start ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ\n"
        "/book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É\n"
        "/my_appointments ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π\n"
        "/services ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞\n"
        "/profile ‚Äî –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/cancel ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n"
        "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üöó <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n"
        "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¢–û)\n"
        "‚Ä¢ –†–µ–º–æ–Ω—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –∏ —Ö–æ–¥–æ–≤–æ–π —á–∞—Å—Ç–∏\n"
        "‚Ä¢ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞\n"
        "‚Ä¢ –ö—É–∑–æ–≤–Ω—ã–µ –∏ –ø–æ–∫—Ä–∞—Å–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã\n"
        "‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        "‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!\n\n"
        "üìû –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–≤–æ–Ω–∏—Ç–µ: +7 (900) 123-45-67"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(commands=['cancel'], state='*')
def cmd_cancel(message: types.Message):
    """–û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."""
    bot.delete_state(message.from_user.id, message.chat.id)
    bot.reply_to(message, "‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.")


# =============================================================================
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
# =============================================================================

@bot.message_handler(commands=['register'])
def cmd_register(message: types.Message):
    """–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    client = db.get_client_by_telegram_id(message.from_user.id)
    if client:
        bot.reply_to(message, f"‚úÖ –í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ <b>{client['name']}</b>", parse_mode='HTML')
        return
    
    text = (
        "üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</b>\n\n"
        "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?\n"
        "<i>(–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏–ª–∏ –§–ò–û)</i>"
    )
    
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_name, message.chat.id)
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_name)
def process_name(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏."""
    name = message.text.strip()
    
    if len(name) < 2:
        bot.reply_to(message, "‚ö†Ô∏è –ò–º—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        data['name'] = name
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–≤–æ–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    bot.set_state(message.from_user.id, ClientRegistration.waiting_for_phone, message.chat.id)
    
    text = (
        f"‚úÖ –û—Ç–ª–∏—á–Ω–æ, <b>{name}</b>!\n\n"
        "üì± –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n"
        "<i>(–ù–∞–ø—Ä–∏–º–µ—Ä: +7 (900) 123-45-67)</i>"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


@bot.message_handler(state=ClientRegistration.waiting_for_phone)
def process_phone(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."""
    phone = message.text.strip()
    
    # –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if len(phone) < 10:
        bot.reply_to(message, "‚ö†Ô∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.")
        return
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ë–î
    with bot.retrieve_data(message.from_user.id, message.chat.id) as data:
        try:
            client_id = db.add_client(
                name=data['name'],
                phone=phone,
                telegram_id=message.from_user.id
            )
            
            text = (
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
                "‚úÖ  <b>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!</b>\n"
                "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
                f"üë§ –ò–º—è: <b>{data['name']}</b>\n"
                f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{phone}</b>\n\n"
                "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª—É–≥—É!\n\n"
                "üìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è\n"
                "üìä /services ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª—É–≥–∏"
            )
            
            bot.reply_to(message, text, parse_mode='HTML')
            
        except Exception as e:
            bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:\n<code>{e}</code>", parse_mode='HTML')
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    bot.delete_state(message.from_user.id, message.chat.id)


# =============================================================================
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥
# =============================================================================

def categorize_services(services):
    """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."""
    categories = {
        'üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞': [],
        'üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏': [],
        'üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        'üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å': [],
        'üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª': [],
        'üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂': [],
        '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞': [],
        'üîß –î–≤–∏–≥–∞—Ç–µ–ª—å': [],
        'üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞': [],
        '‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä': [],
        'üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã': [],
        '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ': []
    }
    
    for service in services:
        name = service['name']
        if '–¢–û' in name or '–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è' in name or '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞' in name.lower() and '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –¢–û –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'].append(service)
        elif '–º–∞—Å–ª–∞' in name or '–º–∞—Å–ª–æ' in name or '–∂–∏–¥–∫–æ—Å—Ç' in name.lower():
            categories['üõ¢Ô∏è –ú–∞—Å–ª–∞ –∏ –∂–∏–¥–∫–æ—Å—Ç–∏'].append(service)
        elif '—Ç–æ—Ä–º–æ–∑' in name.lower():
            categories['üõë –¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif any(word in name.lower() for word in ['–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä', '—Å—Ç–æ–π–∫', '—Ä—É–ª–µ–≤', '—à–∞—Ä–æ–≤', '—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫']):
            categories['üî© –•–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å'].append(service)
        elif '—Ä–∞–∑–≤–∞–ª' in name.lower() or '—Å—Ö–æ–∂–¥–µ–Ω–∏–µ' in name.lower():
            categories['üìê –°—Ö–æ–¥-—Ä–∞–∑–≤–∞–ª'].append(service)
        elif '—à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂' in name.lower() or '–±–∞–ª–∞–Ω—Å–∏—Ä' in name.lower() or '–ø—Ä–æ–∫–æ–ª' in name.lower() or '—Ö—Ä–∞–Ω–µ–Ω–∏–µ' in name.lower():
            categories['üöó –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂'].append(service)
        elif any(word in name.lower() for word in ['–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä', '—ç–ª–µ–∫—Ç—Ä–∏–∫', '—Å–≤–µ—á', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Å—Ç–∞—Ä—Ç–µ—Ä']):
            categories['‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞'].append(service)
        elif any(word in name.lower() for word in ['–≥—Ä–º', '—Ñ–∏–ª—å—Ç—Ä']) or '–¥–≤–∏–≥–∞—Ç–µ–ª' in name.lower():
            categories['üîß –î–≤–∏–≥–∞—Ç–µ–ª—å'].append(service)
        elif '–≤—ã—Ö–ª–æ–ø' in name.lower() or '–≥–ª—É—à–∏—Ç–µ–ª' in name.lower() or '–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä' in name.lower():
            categories['üí® –í—ã—Ö–ª–æ–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'].append(service)
        elif '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä' in name.lower():
            categories['‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä'].append(service)
        elif any(word in name.lower() for word in ['–∫—É–∑–æ–≤', '–ø–æ–∫—Ä–∞—Å–∫–∞', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '—Ä–∏—Ö—Ç–æ–≤–∫–∞', '—Å—Ç–µ–∫–ª–æ']):
            categories['üé® –ö—É–∑–æ–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã'].append(service)
        else:
            categories['‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ'].append(service)
    
    # –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return {k: v for k, v in categories.items() if v}


@bot.message_handler(commands=['services'])
def cmd_services(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        services = db.get_all_services()
        
        if not services:
            bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
            return
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.reply_to(message, text, parse_mode='HTML', reply_markup=keyboard)
        
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("cat_"))
def handle_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[1])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
        show_category_services(call.message, category_name, category_services, page=0)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_category_services(message, category_name, services, page=0):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π."""
    services_per_page = 10
    start_idx = page * services_per_page
    end_idx = min(start_idx + services_per_page, len(services))
    services_page = services[start_idx:end_idx]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    total_pages = (len(services) + services_per_page - 1) // services_per_page
    
    text = (
        "üöó <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n\n"
        f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"üìä –£—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: <b>{len(services)}</b>\n\n"
    )
    
    for i, service in enumerate(services_page, start=start_idx + 1):
        text += (
            f"<b>{i}. {service['name']}</b>\n"
            f"   üí∞ {service['price']} —Ä—É–±. | ‚è± {service['duration_minutes']} –º–∏–Ω.\n"
        )
        if service['description']:
            desc = service['description']
            if len(desc) > 100:
                desc = desc[:97] + "..."
            text += f"   üìù <i>{desc}</i>\n"
        text += "\n"
    
    if total_pages > 1:
        text += f"<i>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1} –∏–∑ {total_pages}</i>\n"
    
    text += "\nüìù –î–ª—è –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /book"
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    buttons = []
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if page > 0:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è callback
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "‚óÄÔ∏è –ù–∞–∑–∞–¥",
                callback_data=f"catpage_{category_index}_{page - 1}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    buttons.append(
        types.InlineKeyboardButton(
            "üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_categories"
        )
    )
    
    # –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (–∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
    if end_idx < len(services):
        all_services = db.get_all_services()
        categories = categorize_services(all_services)
        category_index = list(categories.keys()).index(category_name)
        buttons.append(
            types.InlineKeyboardButton(
                "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
                callback_data=f"catpage_{category_index}_{page + 1}"
            )
        )
    
    keyboard.add(*buttons)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data.startswith("catpage_"))
def handle_category_page(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: catpage_{category_index}_{page}
        parts = call.data.split("_")
        category_index = int(parts[1])
        page = int(parts[2])
        
        # –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –µ—ë —É—Å–ª—É–≥–∏
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        show_category_services(call.message, category_name, category_services, page=page)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data == "back_to_categories")
def handle_back_to_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üöó  <b>–£–°–õ–£–ì–ò –ê–í–¢–û–°–ï–†–í–ò–°–ê</b>\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
            f"üìä –í—Å–µ–≥–æ —É—Å–ª—É–≥: <b>{len(services)}</b>\n"
            f"üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: <b>{len(categories)}</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


# =============================================================================
# –ó–∞–ø–∏—Å—å –Ω–∞ —É—Å–ª—É–≥—É
# =============================================================================

@bot.message_handler(commands=['book'])
def cmd_book(message: types.Message):
    """–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏ - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –ü–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏
    services = db.get_all_services()
    if not services:
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥")
        return
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    categories = categorize_services(services)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    for category_name, category_services in categories.items():
        keyboard.add(
            types.InlineKeyboardButton(
                f"{category_name} ({len(category_services)})",
                callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
            )
        )
    
    text = (
        "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
    )
    
    bot.send_message(message.chat.id, text, parse_mode='HTML', reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: call.data.startswith("book_cat_"))
def handle_booking_category_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É—Å–ª—É–≥–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º
        services = db.get_all_services()
        categories = categorize_services(services)
        category_names = list(categories.keys())
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_index = int(call.data.split("_")[2])
        category_name = category_names[category_index]
        category_services = categories[category_name]
        
        bot.answer_callback_query(call.id)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        show_booking_services(call.message, category_name, category_services, category_index)
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


def show_booking_services(message, category_name, services, category_index):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ª—É–≥–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É—Å–ª—É–≥–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=1)
    
    for service in services:
        keyboard.add(
            types.InlineKeyboardButton(
                f"{service['name']} - {service['price']} —Ä—É–±.",
                callback_data=f"bookserv_{service['id']}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ö –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
            callback_data="back_to_booking_categories"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b>{category_name}</b>\n"
        f"–®–∞–≥ 2Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É ({len(services)} –¥–æ—Å—Ç—É–ø–Ω–æ):"
    )
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    try:
        bot.edit_message_text(
            text,
            message.chat.id,
            message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except:
        bot.send_message(
            message.chat.id,
            text,
            parse_mode='HTML',
            reply_markup=keyboard
        )


@bot.callback_query_handler(func=lambda call: call.data == "back_to_booking_categories")
def handle_back_to_booking_categories(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏."""
    try:
        services = db.get_all_services()
        categories = categorize_services(services)
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        
        for category_name, category_services in categories.items():
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{category_name} ({len(category_services)})",
                    callback_data=f"book_cat_{list(categories.keys()).index(category_name)}"
                )
            )
        
        text = (
            "üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            "–®–∞–≥ 1Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥–∏"
        )
        
        bot.answer_callback_query(call.id)
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
        
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("bookserv_"))
def handle_service_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    service_id = int(call.data.split("_")[1])
    service = db.get_service_by_id(service_id)
    
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    bot.answer_callback_query(call.id)
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    today = datetime.now()
    
    for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
        date = today + timedelta(days=i)
        date_str = date.strftime("%d.%m.%Y")
        weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
        
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                f"{weekday}, {date_str}",
                callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
            )
        )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
        f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("bdate_"))
def handle_booking_date_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏."""
    # –ü–∞—Ä—Å–∏–º callback_data: bdate_{service_id}_{date}
    parts = call.data.split("_")
    service_id = int(parts[1])
    date_str = parts[2]
    
    bot.answer_callback_query(call.id)
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
    service = db.get_service_by_id(service_id)
    if not service:
        bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
    keyboard = types.InlineKeyboardMarkup(row_width=3)
    times = ["09:00", "10:00", "11:00", "12:00", "14:00", "15:00", "16:00", "17:00", "18:00"]
    
    for time in times:
        # –ü–µ—Ä–µ–¥–∞—ë–º service_id –∏ –¥–∞—Ç—É –≤ callback_data
        keyboard.add(
            types.InlineKeyboardButton(
                time,
                callback_data=f"btime_{service_id}_{date_str}_{time}"
            )
        )
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" —Å service_id
    keyboard.add(
        types.InlineKeyboardButton(
            "üîô –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º",
            callback_data=f"backserv_{service_id}"
        )
    )
    
    text = (
        f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
        f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
        f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n"
        f"üìÖ –î–∞—Ç–∞: <b>{datetime.strptime(date_str, '%Y-%m-%d').strftime('%d.%m.%Y')}</b>\n\n"
        f"–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:"
    )
    
    bot.edit_message_text(
        text,
        call.message.chat.id,
        call.message.message_id,
        parse_mode='HTML',
        reply_markup=keyboard
    )


@bot.callback_query_handler(func=lambda call: call.data.startswith("backserv_"))
def handle_back_to_dates(call: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã."""
    try:
        # –ü–æ–ª—É—á–∞–µ–º service_id –∏–∑ callback_data
        service_id = int(call.data.split("_")[1])
        
        bot.answer_callback_query(call.id)
        
        service = db.get_service_by_id(service_id)
        if not service:
            bot.answer_callback_query(call.id, "‚ùå –£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            return
        
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –¥–∞—Ç–∞–º–∏
        keyboard = types.InlineKeyboardMarkup(row_width=2)
        today = datetime.now()
        
        for i in range(7):  # –°–ª–µ–¥—É—é—â–∏–µ 7 –¥–Ω–µ–π
            date = today + timedelta(days=i)
            date_str = date.strftime("%d.%m.%Y")
            weekday = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"][date.weekday()]
            
            keyboard.add(
                types.InlineKeyboardButton(
                    f"{weekday}, {date_str}",
                    callback_data=f"bdate_{service_id}_{date.strftime('%Y-%m-%d')}"
                )
            )
        
        text = (
            f"üìù <b>–ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£</b>\n\n"
            f"‚úÖ –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –¶–µ–Ω–∞: <b>{service['price']} —Ä—É–±.</b>\n\n"
            f"–®–∞–≥ 3Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML',
            reply_markup=keyboard
        )
    except Exception as e:
        bot.answer_callback_query(call.id, f"‚ùå –û—à–∏–±–∫–∞: {e}")


@bot.callback_query_handler(func=lambda call: call.data.startswith("btime_"))
def handle_booking_time_selection(call: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏."""
    try:
        # –ü–∞—Ä—Å–∏–º callback_data: btime_{service_id}_{date}_{time}
        parts = call.data.split("_")
        service_id = int(parts[1])
        date_str = parts[2]
        time_str = parts[3]
        
        bot.answer_callback_query(call.id, "‚è≥ –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å...")
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        service = db.get_service_by_id(service_id)
        if not service:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: —É—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        date_obj = datetime.strptime(date_str, '%Y-%m-%d')
        date_display = date_obj.strftime('%d.%m.%Y')
        weekday = ["–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–≤—Ç–æ—Ä–Ω–∏–∫", "—Å—Ä–µ–¥—É", "—á–µ—Ç–≤–µ—Ä–≥", "–ø—è—Ç–Ω–∏—Ü—É", "—Å—É–±–±–æ—Ç—É", "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"][date_obj.weekday()]
        datetime_str = f"{date_str} {time_str}"
        appointment_datetime = datetime.strptime(datetime_str, '%Y-%m-%d %H:%M')
        
        # –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
        client = db.get_client_by_telegram_id(call.from_user.id)
        
        if not client:
            bot.edit_message_text(
                "‚ùå –û—à–∏–±–∫–∞: –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register",
                call.message.chat.id,
                call.message.message_id
            )
            return
        
        appointment_id = db.add_appointment(
            client_id=client['id'],
            service_id=service_id,
            appointment_datetime=appointment_datetime
        )
        
        # –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        text = (
            "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
            "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
            "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
            f"üë§ –ö–ª–∏–µ–Ω—Ç: <b>{client['name']}</b>\n"
            f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n\n"
            f"üîß –£—Å–ª—É–≥–∞: <b>{service['name']}</b>\n"
            f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>{service['price']} —Ä—É–±.</b>\n"
            f"‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: <b>{service['duration_minutes']} –º–∏–Ω.</b>\n\n"
            f"üìÖ –î–∞—Ç–∞: <b>{date_display}</b> ({weekday})\n"
            f"üïê –í—Ä–µ–º—è: <b>{time_str}</b>\n\n"
            f"üìã –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏: <b>#{appointment_id}</b>\n\n"
            "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            "üíº <b>–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª</b>\n"
            "–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è! üöó\n\n"
            "<i>–ó–∞ 1 –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ.</i>\n\n"
            "üìã /my_appointments ‚Äî –≤—Å–µ –º–æ–∏ –∑–∞–ø–∏—Å–∏\n"
            "üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã: +7 (900) 123-45-67"
        )
        
        bot.edit_message_text(
            text,
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML'
        )
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
        thanks_message = (
            "üôè <b>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤—ã–±–æ—Ä!</b>\n\n"
            "–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ –∫–∞–∫ –æ —Å–≤–æ—ë–º.\n"
            "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!\n\n"
            "üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –∑–∞ –¥–µ–Ω—å –¥–æ –≤–∏–∑–∏—Ç–∞."
        )
        bot.send_message(
            call.message.chat.id,
            thanks_message,
            parse_mode='HTML'
        )
        
    except Exception as e:
        bot.edit_message_text(
            f"‚ùå <b>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏</b>\n\n"
            f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å:\n"
            f"<code>{e}</code>\n\n"
            f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:\n"
            f"üìû +7 (900) 123-45-67",
            call.message.chat.id,
            call.message.message_id,
            parse_mode='HTML'
        )


# =============================================================================
# –ú–æ–∏ –∑–∞–ø–∏—Å–∏
# =============================================================================

@bot.message_handler(commands=['my_appointments'])
def cmd_my_appointments(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    appointments = db.get_client_appointments(client['id'])
    
    if not appointments:
        bot.reply_to(message, "üìã –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π\n\nüìù /book ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
        return
    
    text = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã  <b>–ú–û–ò –ó–ê–ü–ò–°–ò</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
    
    for app in appointments:
        status_emoji = {
            'pending': 'üïê',
            'confirmed': '‚úÖ',
            'cancelled': '‚ùå',
            'completed': '‚úîÔ∏è'
        }.get(app['status'], '‚ùì')
        
        dt = app['appointment_datetime']
        date_str = dt.strftime('%d.%m.%Y %H:%M')
        
        text += (
            f"{status_emoji} <b>#{app['id']}</b>\n"
            f"   üîπ {app['service_name']}\n"
            f"   üìÖ {date_str}\n"
            f"   üí∞ {app['price']} —Ä—É–±.\n"
            f"   –°—Ç–∞—Ç—É—Å: {app['status']}\n\n"
        )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –ü—Ä–æ—Ñ–∏–ª—å
# =============================================================================

@bot.message_handler(commands=['profile'])
def cmd_profile(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    client = db.get_client_by_telegram_id(message.from_user.id)
    if not client:
        bot.reply_to(message, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: /register")
        return
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–∏—Å–µ–π
    appointments = db.get_client_appointments(client['id'])
    completed = len([a for a in appointments if a['status'] == 'completed'])
    
    text = (
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "üë§  <b>–ú–û–ô –ü–†–û–§–ò–õ–¨</b>\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n"
        f"–ò–º—è: <b>{client['name']}</b>\n"
        f"–¢–µ–ª–µ—Ñ–æ–Ω: <b>{client['phone']}</b>\n"
        f"–ó–∞–ø–∏—Å–µ–π: <b>{len(appointments)}</b>\n"
        f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>{completed}</b>\n\n"
        f"–ö–ª–∏–µ–Ω—Ç —Å: {client['created_at'].strftime('%d.%m.%Y')}"
    )
    
    bot.reply_to(message, text, parse_mode='HTML')


# =============================================================================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
# =============================================================================

@bot.message_handler(func=lambda message: True, state=None)
def handle_unknown(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = (
        "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥."
    )
    
    bot.reply_to(message, text)


# =============================================================================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =============================================================================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ."""
    print("=" * 70)
    print("üöó Telegram-–±–æ—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ ¬´–ü—Ä–æ—Ñ–∏–°–µ—Ä–≤–∏—Å¬ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    if db.test_connection():
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = db.get_stats()
        print(f"\nüìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {stats['clients_count']}")
        print(f"   ‚Ä¢ –£—Å–ª—É–≥: {stats['services_count']}")
        print(f"   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π: {stats['appointments_count']}")
        
        if stats['services_count'] == 0:
            print("\n‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –í –±–∞–∑–µ –Ω–µ—Ç —É—Å–ª—É–≥!")
            print("   –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python add_autoservice_services.py")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")
        return
    
    print("\n" + "=" * 70)
    print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    print("=" * 70 + "\n")
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.infinity_polling(timeout=60, long_polling_timeout=60)


if __name__ == '__main__':
    main()


```

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, –Ω–µ—Ç –ª–∏ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å:

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ **–ü—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### **–ü—Ä–æ–±–ª–µ–º–∞:**
–î–∞–Ω–Ω—ã–µ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —É—Å–ª—É–≥–µ —Ç–µ—Ä—è–ª–∏—Å—å –º–µ–∂–¥—É —à–∞–≥–∞–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ `bot.retrieve_data` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ states, –∞ callback-—Ö–µ–Ω–¥–ª–µ—Ä—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

### **–†–µ—à–µ–Ω–∏–µ:**
–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥–µ–ª–∞–ª —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö - —Ç–µ–ø–µ—Ä—å –≤—Å–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `callback_data`:

1. **–ü—Ä–∏ –≤—ã–±–æ—Ä–µ —É—Å–ª—É–≥–∏** ‚Üí `bookserv_{service_id}`
2. **–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–∞—Ç—ã** ‚Üí `bdate_{service_id}_{date}`
3. **–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏** ‚Üí `btime_{service_id}_{date}_{time}`
4. **–ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"** ‚Üí `backserv_{service_id}`

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1Ô∏è‚É£ **–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö**
```
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 04.12.2025

–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:
```

### 2Ô∏è‚É£ **KeyError –∏—Å–ø—Ä–∞–≤–ª–µ–Ω**
–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –Ω–∞–¥–µ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ callback_data, –æ—à–∏–±–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç.

### 3Ô∏è‚É£ **–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**
–°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¥–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–ø–∏—Å–∏
- –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –≤—ã–±–æ—Ä

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
# Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
.\venv\Scripts\python.exe bot.py
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:**
1. `/book` ‚Üí –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
2. –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí **–Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ —à–∞–ø–∫–µ**
3. –í—ã–±–æ—Ä –¥–∞—Ç—ã ‚Üí **–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è**
4. –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ ‚Üí **–≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!** ‚úÖ

–¢–µ–ø–µ—Ä—å –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ! üéâ

```plaintext
üìù –ó–ê–ü–ò–°–¨ –ù–ê –£–°–õ–£–ì–£

‚úÖ –£—Å–ª—É–≥–∞: –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ R16-R17 (4 –∫–æ–ª–µ—Å–∞)
üí∞ –¶–µ–Ω–∞: 2000 —Ä—É–±.
üìÖ –î–∞—Ç–∞: 04.12.2025

–®–∞–≥ 4Ô∏è‚É£: –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:
```

```shellscript
# Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
.\venv\Scripts\python.exe bot.py
```

---

**User**

–•–æ—Ä–æ—à–æ, –º—ã –ø–æ—á—Ç–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏. –ü–æ–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∫—Ä–∞—Å–∏–≤–æ –±—ã–ª–æ. –¢—ã —É–∂–µ —Å —Ç–∞–∫–∏–º —Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è —Ä–∞–Ω—å—à–µ

            "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
            "‚ïë  ‚úÖ  <b>–ó–ê–ü–ò–°–¨ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê!</b>  ‚ïë\n"
            "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"

